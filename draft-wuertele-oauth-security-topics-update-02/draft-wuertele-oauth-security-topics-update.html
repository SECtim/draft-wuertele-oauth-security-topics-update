<!DOCTYPE html>
<html lang="en" class="Internet-Draft bcp">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Updates to OAuth 2.0 Security Best Current Practice</title>
<meta content="Tim Würtele" name="author">
<meta content="Pedram Hosseyni" name="author">
<meta content="Kaixuan Luo" name="author">
<meta content="Adonis Fung" name="author">
<meta content="
       This document updates the set of best current security practices for
OAuth 2.0 by extending the security advice given in RFC 6749, RFC
6750, and RFC 9700, to cover new threats that have been discovered
since the former documents have been published. 
    " name="description">
<meta content="xml2rfc 3.30.2" name="generator">
<meta content="security" name="keyword">
<meta content="oauth2" name="keyword">
<meta content="best current practice" name="keyword">
<meta content="draft-wuertele-oauth-security-topics-update-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.30.2
    Python 3.12.11
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.6
    lxml 5.3.1
    platformdirs 4.4.0
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.5
    setuptools 80.9.0
    wcwidth 0.2.13
-->
<link href="draft-wuertele-oauth-security-topics-update.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Updates to OAuth 2.0 Security BCP</td>
<td class="right">September 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Würtele, et al.</td>
<td class="center">Expires 2 April 2026</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Web Authorization Protocol</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-wuertele-oauth-security-topics-update-latest</dd>
<dt class="label-bcp">bcp:</dt>
<dd class="bcp">240</dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a href="https://www.rfc-editor.org/rfc/rfc6749" class="eref">6749</a>, <a href="https://www.rfc-editor.org/rfc/rfc6750" class="eref">6750</a>, <a href="https://www.rfc-editor.org/rfc/rfc7521" class="eref">7521</a>, <a href="https://www.rfc-editor.org/rfc/rfc7522" class="eref">7522</a>, <a href="https://www.rfc-editor.org/rfc/rfc7523" class="eref">7523</a>, <a href="https://www.rfc-editor.org/rfc/rfc9700" class="eref">9700</a> (if approved)</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-09-29" class="published">29 September 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Best Current Practice</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2026-04-02">2 April 2026</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">T. Würtele</div>
<div class="org">University of Stuttgart</div>
</div>
<div class="author">
      <div class="author-name">P. Hosseyni</div>
<div class="org">University of Stuttgart</div>
</div>
<div class="author">
      <div class="author-name">K. Luo</div>
<div class="org">The Chinese University of Hong Kong</div>
</div>
<div class="author">
      <div class="author-name">A. Fung</div>
<div class="org">Samsung Research America</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Updates to OAuth 2.0 Security Best Current Practice</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document updates the set of best current security practices for
OAuth 2.0 by extending the security advice given in RFC 6749, RFC
6750, and RFC 9700, to cover new threats that have been discovered
since the former documents have been published.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://SECtim.github.io/draft-wuertele-oauth-security-topics-update/draft-wuertele-oauth-security-topics-update.html">https://SECtim.github.io/draft-wuertele-oauth-security-topics-update/draft-wuertele-oauth-security-topics-update.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-wuertele-oauth-security-topics-update/">https://datatracker.ietf.org/doc/draft-wuertele-oauth-security-topics-update/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        Web Authorization Protocol  mailing list (<span><a href="mailto:oauth@ietf.org">mailto:oauth@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/oauth/">https://mailarchive.ietf.org/arch/browse/oauth/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/oauth/">https://www.ietf.org/mailman/listinfo/oauth/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/SECtim/draft-wuertele-oauth-security-topics-update">https://github.com/SECtim/draft-wuertele-oauth-security-topics-update</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 2 April 2026.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-structure" class="internal xref">Structure</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-conventions-and-terminology" class="internal xref">Conventions and Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-attacks-and-mitigations" class="internal xref">Attacks and Mitigations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-audience-injection-attacks" class="internal xref">Audience Injection Attacks</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.1">
                    <p id="section-toc.1-1.2.2.1.2.1.1"><a href="#section-2.1.1" class="auto internal xref">2.1.1</a>.  <a href="#name-attack-description" class="internal xref">Attack Description</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.2">
                    <p id="section-toc.1-1.2.2.1.2.2.1"><a href="#section-2.1.2" class="auto internal xref">2.1.2</a>.  <a href="#name-countermeasures" class="internal xref">Countermeasures</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-cross-tool-oauth-account-ta" class="internal xref">Cross-tool OAuth Account Takeover</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.1">
                    <p id="section-toc.1-1.2.2.2.2.1.1"><a href="#section-2.2.1" class="auto internal xref">2.2.1</a>.  <a href="#name-attack-description-2" class="internal xref">Attack Description</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.2">
                    <p id="section-toc.1-1.2.2.2.2.2.1"><a href="#section-2.2.2" class="auto internal xref">2.2.2</a>.  <a href="#name-countermeasures-2" class="internal xref">Countermeasures</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="auto internal xref">2.3</a>.  <a href="#name-cross-user-oauth-session-fi" class="internal xref">Cross-user OAuth Session Fixation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.1">
                    <p id="section-toc.1-1.2.2.3.2.1.1"><a href="#section-2.3.1" class="auto internal xref">2.3.1</a>.  <a href="#name-attack-description-3" class="internal xref">Attack Description</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.2">
                    <p id="section-toc.1-1.2.2.3.2.2.1"><a href="#section-2.3.2" class="auto internal xref">2.3.2</a>.  <a href="#name-countermeasures-3" class="internal xref">Countermeasures</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-document-history" class="internal xref">Document History</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="Introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Since the publication of the first OAuth 2.0 Security Best Practices
document <span>[<a href="#RFC9700" class="cite xref">RFC9700</a>]</span>, new threats to OAuth 2.0 ecosystems have been
identified. This document therefore serves as an extension of the
original <span>[<a href="#RFC9700" class="cite xref">RFC9700</a>]</span> and is to be read in conjunction with it.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Like <span>[<a href="#RFC9700" class="cite xref">RFC9700</a>]</span> before, this document provides important security
recommendations and it is <span class="bcp14">RECOMMENDED</span> that implementers upgrade their
implementations and ecosystems as soon as feasible.<a href="#section-1-2" class="pilcrow">¶</a></p>
<div id="structure">
<section id="section-1.1">
        <h3 id="name-structure">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-structure" class="section-name selfRef">Structure</a>
        </h3>
<p id="section-1.1-1">The remainder of this document is organized as follows: Section 2 is a detailed analysis of the threats and implementation issues that can be found in the wild (at the time of writing) along with a discussion of potential countermeasures.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conventions-and-terminology">
<section id="section-1.2">
        <h3 id="name-conventions-and-terminology">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-conventions-and-terminology" class="section-name selfRef">Conventions and Terminology</a>
        </h3>
<p id="section-1.2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<p id="section-1.2-2">This specification uses the terms "access token", "authorization
endpoint", "authorization grant", "authorization server", "client",
"client identifier" (client ID), "protected resource", "refresh
token", "resource owner", "resource server", and "token endpoint"
defined by OAuth 2.0 <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>.<a href="#section-1.2-2" class="pilcrow">¶</a></p>
<p id="section-1.2-3"><span class="cref" id="terminology-update">Make sure to update this list once the
technical sections below are completed.<span class="crefSource">Tim W.</span></span><a href="#section-1.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="AttacksMitigations">
<section id="section-2">
      <h2 id="name-attacks-and-mitigations">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-attacks-and-mitigations" class="section-name selfRef">Attacks and Mitigations</a>
      </h2>
<p id="section-2-1">This section gives a detailed description of new attacks on OAuth implementations, along with potential countermeasures. Attacks and mitigations already covered in <span>[<a href="#RFC9700" class="cite xref">RFC9700</a>]</span> are not listed here, except where clarifications or new recommendations are made.<a href="#section-2-1" class="pilcrow">¶</a></p>
<div id="AudienceInjection">
<section id="section-2.1">
        <h3 id="name-audience-injection-attacks">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-audience-injection-attacks" class="section-name selfRef">Audience Injection Attacks</a>
        </h3>
<p id="section-2.1-1">When using signature-based client authentication methods such as
<code>private_key_jwt</code> as defined in <span>[<a href="#OpenID.Core" class="cite xref">OpenID.Core</a>]</span> or signed JWTs as
defined in <span>[<a href="#RFC7521" class="cite xref">RFC7521</a>]</span> and <span>[<a href="#RFC7523" class="cite xref">RFC7523</a>]</span>, a malicious authorization
server may be able to obtain and use a client's authentication
credential, enabling them to impersonate a client towards another
honest authorization server.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<div id="attack-description">
<section id="section-2.1.1">
          <h4 id="name-attack-description">
<a href="#section-2.1.1" class="section-number selfRef">2.1.1. </a><a href="#name-attack-description" class="section-name selfRef">Attack Description</a>
          </h4>
<p id="section-2.1.1-1">The descriptions here follow <span>[<a href="#research.ust" class="cite xref">research.ust</a>]</span>, where additional details
of the attack are laid out.  Audience injection attacks require a client
to interact with at least two authorization servers, one of which is
malicious, and to authenticate to both with a signature-based
authentication method using the same key pair.  The following
description uses the <code>jwt-bearer</code> client authentication from
<span>[<a href="#RFC7523" class="cite xref">RFC7523</a>]</span>, see <a href="#AudienceInjectionAuthNMethods" class="auto internal xref">Section 2.1.1.3</a> for other affected
client authentication methods.  Furthermore, the client needs to be
willing to authenticate at an endpoint other than the token endpoint at
the attacker authorization server (see <a href="#AudienceInjectionEndpoints" class="auto internal xref">Section 2.1.1.2</a>).<a href="#section-2.1.1-1" class="pilcrow">¶</a></p>
<div id="core-attack-steps">
<section id="section-2.1.1.1">
            <h5 id="name-core-attack-steps">
<a href="#section-2.1.1.1" class="section-number selfRef">2.1.1.1. </a><a href="#name-core-attack-steps" class="section-name selfRef">Core Attack Steps</a>
            </h5>
<p id="section-2.1.1.1-1">In the following, let H-AS be an honest authorization server and let
A-AS be an attacker-controlled authorization server.<a href="#section-2.1.1.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1.1.1-2">Assume that the authorization servers publish the following URIs for
their token endpoints, for example via mechanisms such as authorization
server metadata <span>[<a href="#RFC8414" class="cite xref">RFC8414</a>]</span> or OpenID Discovery <span>[<a href="#OpenID.Discovery" class="cite xref">OpenID.Discovery</a>]</span>.
The exact publication mechanism is not relevant, as audience injection
attacks are also possible on clients with manually configured
authorization server metadata.<a href="#section-2.1.1.1-2" class="pilcrow">¶</a></p>
<p id="section-2.1.1.1-3">Excerpt from H-AS' metadata:<a href="#section-2.1.1.1-3" class="pilcrow">¶</a></p>
<div class="lang-javascript sourcecode" id="section-2.1.1.1-4">
<pre>
"issuer": "https://honest.com",
"token_endpoint": "https://honest.com/token",
...
</pre><a href="#section-2.1.1.1-4" class="pilcrow">¶</a>
</div>
<p id="section-2.1.1.1-5">Excerpt from A-AS' metadata:<a href="#section-2.1.1.1-5" class="pilcrow">¶</a></p>
<div class="lang-javascript sourcecode" id="section-2.1.1.1-6">
<pre>
"issuer": "https://attacker.com",
"token_endpoint": "https://honest.com/token",
...
</pre><a href="#section-2.1.1.1-6" class="pilcrow">¶</a>
</div>
<p id="section-2.1.1.1-7">Therefore, the attacker authorization server claims to use the honest
authorization server's token endpoint. Note that the attacker
authorization server does not control this endpoint. The attack then
commences as follows:<a href="#section-2.1.1.1-7" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.1.1.1-8">
<li id="section-2.1.1.1-8.1">
                <p id="section-2.1.1.1-8.1.1">Client registers at H-AS, and gets assigned a client ID <code>cid</code>.<a href="#section-2.1.1.1-8.1.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-2.1.1.1-8.2">
                <p id="section-2.1.1.1-8.2.1">Client registers at A-AS, and gets assigned the same client ID
<code>cid</code>. Note that the client ID is not a secret (<span><a href="https://rfc-editor.org/rfc/rfc6749#section-2.2" class="relref">Section 2.2</a> of [<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>).<a href="#section-2.1.1.1-8.2.1" class="pilcrow">¶</a></p>
</li>
            </ol>
<p id="section-2.1.1.1-9">Now, whenever the client creates a client assertion for authentication
to A-AS, the assertion consists of a JSON Web Token (JWT) that is signed
by the client and contains, among others, the following claims:<a href="#section-2.1.1.1-9" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-2.1.1.1-10">
<pre>
"iss": "cid",
"sub": "cid",
"aud": "https://honest.com/token"
</pre><a href="#section-2.1.1.1-10" class="pilcrow">¶</a>
</div>
<p id="section-2.1.1.1-11">Due to the malicious use of H-AS' token endpoint in A-AS'
authorization server metadata, the <code>aud</code> claim contains H-AS' token
endpoint.  Recall that both A-AS and H-AS registered the client with
client ID <code>cid</code>, and that the client uses the same key pair for
authentication at both authorization servers.  Hence, this client
assertion is a valid authentication credential for the client at
H-AS.<a href="#section-2.1.1.1-11" class="pilcrow">¶</a></p>
<p id="section-2.1.1.1-12">The use of the token endpoint to identify the authorization server as a
client assertion's audience even for client assertions that are not sent
to the token endpoint is encouraged, or at least allowed by many
standards, including <span>[<a href="#RFC7521" class="cite xref">RFC7521</a>]</span>, <span>[<a href="#RFC7522" class="cite xref">RFC7522</a>]</span>, <span>[<a href="#RFC7523" class="cite xref">RFC7523</a>]</span>, <span>[<a href="#RFC9126" class="cite xref">RFC9126</a>]</span>,
<span>[<a href="#OpenID.Core" class="cite xref">OpenID.Core</a>]</span>, <span>[<a href="#OpenID.CIBA" class="cite xref">OpenID.CIBA</a>]</span>, and all standards referencing the IANA
registry for OAuth Token Endpoint Authentication Methods for available
client authentication methods.<a href="#section-2.1.1.1-12" class="pilcrow">¶</a></p>
<p id="section-2.1.1.1-13">As described in <span>[<a href="#research.ust" class="cite xref">research.ust</a>]</span>, the attacker can then utilize the
obtained client authentication assertion to impersonate the client and,
for example, obtain access tokens.<a href="#section-2.1.1.1-13" class="pilcrow">¶</a></p>
</section>
</div>
<div id="AudienceInjectionEndpoints">
<section id="section-2.1.1.2">
            <h5 id="name-endpoints-requiring-client-">
<a href="#section-2.1.1.2" class="section-number selfRef">2.1.1.2. </a><a href="#name-endpoints-requiring-client-" class="section-name selfRef">Endpoints Requiring Client Authentication</a>
            </h5>
<p id="section-2.1.1.2-1">As mentioned above, the attack is only possible if the client
authenticates to an endpoint other than the token endpoint at A-AS.
This is because if the client sends a token request to A-AS, it will use
A-AS' token endpoint as published by A-AS and hence, send the token
request to H-AS, i.e., the attacker cannot obtain the client assertion.<a href="#section-2.1.1.2-1" class="pilcrow">¶</a></p>
<p id="section-2.1.1.2-2">As detailed in <span>[<a href="#research.ust" class="cite xref">research.ust</a>]</span>, the attack is confirmed to be possible
if the client authenticates with such client assertions at the following
endpoints of A-AS:<a href="#section-2.1.1.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1.1.2-3.1">
                <p id="section-2.1.1.2-3.1.1">Pushed Authorization Endpoint (see <span>[<a href="#RFC9126" class="cite xref">RFC9126</a>]</span>)<a href="#section-2.1.1.2-3.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.1.1.2-3.2">
                <p id="section-2.1.1.2-3.2.1">Token Revocation Endpoint (see <span>[<a href="#RFC7009" class="cite xref">RFC7009</a>]</span>)<a href="#section-2.1.1.2-3.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.1.1.2-3.3">
                <p id="section-2.1.1.2-3.3.1">CIBA Backchannel Authentication Endpoint (see <span>[<a href="#OpenID.CIBA" class="cite xref">OpenID.CIBA</a>]</span>)<a href="#section-2.1.1.2-3.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.1.1.2-3.4">
                <p id="section-2.1.1.2-3.4.1">Device Authorization Endpoint (see <span>[<a href="#RFC8628" class="cite xref">RFC8628</a>]</span>)<a href="#section-2.1.1.2-3.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-2.1.1.2-4">Note that this list of examples is not exhaustive. Hence, any client
that might authenticate at any endpoint other than the token endpoint
<span class="bcp14">SHOULD</span> employ countermeasures as described in
<a href="#AudienceInjectionCountermeasures" class="auto internal xref">Section 2.1.2</a>.<a href="#section-2.1.1.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="AudienceInjectionAuthNMethods">
<section id="section-2.1.1.3">
            <h5 id="name-affected-client-authenticat">
<a href="#section-2.1.1.3" class="section-number selfRef">2.1.1.3. </a><a href="#name-affected-client-authenticat" class="section-name selfRef">Affected Client Authentication Methods</a>
            </h5>
<p id="section-2.1.1.3-1">The same attacks are possible for the <code>private_key_jwt</code> client
authentication method defined in <span>[<a href="#OpenID.Core" class="cite xref">OpenID.Core</a>]</span>, as well as
instantiations of client authentication assertions defined in
<span>[<a href="#RFC7521" class="cite xref">RFC7521</a>]</span>, including the SAML assertions defined in <span>[<a href="#RFC7522" class="cite xref">RFC7522</a>]</span>.<a href="#section-2.1.1.3-1" class="pilcrow">¶</a></p>
<p id="section-2.1.1.3-2">Furthermore, a similar attack is possible for <code>jwt-bearer</code> authorization
grants as defined in <span><a href="https://rfc-editor.org/rfc/rfc7523#section-2.1" class="relref">Section 2.1</a> of [<a href="#RFC7523" class="cite xref">RFC7523</a>]</span>, albeit under
additional assumptions (see <span>[<a href="#research.ust" class="cite xref">research.ust</a>]</span> for details).<a href="#section-2.1.1.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="AudienceInjectionCountermeasures">
<section id="section-2.1.2">
          <h4 id="name-countermeasures">
<a href="#section-2.1.2" class="section-number selfRef">2.1.2. </a><a href="#name-countermeasures" class="section-name selfRef">Countermeasures</a>
          </h4>
<p id="section-2.1.2-1">At its core, audience injection attacks exploit the fact that, from the
client's point of view, an authorization server's token endpoint is a
mostly opaque value and does not uniquely identify an authorization
server.  Therefore, an attacker authorization server may claim any URI
as its token endpoint, including, for example, an honest authorization
server's issuer identifier. Hence, as long as a client uses the token
endpoint as an audience value when authenticating to the attacker
authorization server, audience injection attacks are possible.
Therefore, audience injection attacks need to be prevented by the
client.<a href="#section-2.1.2-1" class="pilcrow">¶</a></p>
<p id="section-2.1.2-2">Note that the following countermeasures mandate the use of single
audience value (as opposed to multiple audiences in array). This is because <span><a href="https://rfc-editor.org/rfc/rfc7519#section-4.1.3" class="relref">Section 4.1.3</a> of [<a href="#RFC7519" class="cite xref">RFC7519</a>]</span> allows the receiver of an audience-restricted JWT to
accept the JWT even if the receiver identifies with only one of the
values in such an array.<a href="#section-2.1.2-2" class="pilcrow">¶</a></p>
<p id="section-2.1.2-3">Clients that interact with more than one authorization server and
authenticate with signature-based client authentication methods <span class="bcp14">MUST</span>
employ one of the following countermeasures, unless audience injection
attacks are mitigated by other means, such as using fresh key material
for each authorization server.<a href="#section-2.1.2-3" class="pilcrow">¶</a></p>
<p id="section-2.1.2-4">Note that the countermeasures described in
<a href="#AudienceInjectionCountermeasuresASissuer" class="auto internal xref">Section 2.1.2.1</a> and
<a href="#AudienceInjectionCountermeasuresTargetEP" class="auto internal xref">Section 2.1.2.2</a> do not imply any normative
changes to the authorization server: <span><a href="https://rfc-editor.org/rfc/rfc7519#section-4.1.3" class="relref">Section 4.1.3</a> of [<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>
requires the authorization server to only accept a JWT if the
authorization server can identify itself with (at least one of the
elements in) the JWT's audience value. Authentication JWTs produced by a
client implementing one of these countermeasures meet this condition.
Of course, an authorization server <span class="bcp14">MAY</span> still decide to only accept its
issuer identifier (<a href="#AudienceInjectionCountermeasuresASissuer" class="auto internal xref">Section 2.1.2.1</a>) or the
endpoint that received the JWT
(<a href="#AudienceInjectionCountermeasuresTargetEP" class="auto internal xref">Section 2.1.2.2</a>) as an audience value, for
example, to force its clients to adopt the respective countermeasure.<a href="#section-2.1.2-4" class="pilcrow">¶</a></p>
<div id="AudienceInjectionCountermeasuresASissuer">
<section id="section-2.1.2.1">
            <h5 id="name-authorization-server-issuer">
<a href="#section-2.1.2.1" class="section-number selfRef">2.1.2.1. </a><a href="#name-authorization-server-issuer" class="section-name selfRef">Authorization Server Issuer Identifier</a>
            </h5>
<p id="section-2.1.2.1-1">Clients <span class="bcp14">MUST</span> use the authorization server's issuer identifier as defined
in <span>[<a href="#RFC8414" class="cite xref">RFC8414</a>]</span>/<span>[<a href="#OpenID.Discovery" class="cite xref">OpenID.Discovery</a>]</span> as the sole audience value in
client assertions. Clients <span class="bcp14">MUST</span> retrieve and validate this value as
described in <span><a href="https://rfc-editor.org/rfc/rfc8414#section-3.3" class="relref">Section 3.3</a> of [<a href="#RFC8414" class="cite xref">RFC8414</a>]</span>/Section 4.3 of
<span>[<a href="#OpenID.Discovery" class="cite xref">OpenID.Discovery</a>]</span>.<a href="#section-2.1.2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1.2.1-2">For <code>jwt-bearer</code> client assertions as defined by <span>[<a href="#RFC7523" class="cite xref">RFC7523</a>]</span>, this
mechanism is also described in <span>[<a href="#OAUTH-7523bis" class="cite xref">OAUTH-7523bis</a>]</span>.<a href="#section-2.1.2.1-2" class="pilcrow">¶</a></p>
<p id="section-2.1.2.1-3">Note that "issuer identifier" here does not refer to the term "issuer"
as defined in <span><a href="https://rfc-editor.org/rfc/rfc9700#section-4.4" class="relref">Section 4.4</a> of [<a href="#RFC9700" class="cite xref">RFC9700</a>]</span>, but to the issuer identifier
defined in <span>[<a href="#RFC8414" class="cite xref">RFC8414</a>]</span> and <span>[<a href="#OpenID.Discovery" class="cite xref">OpenID.Discovery</a>]</span>. In particular, the
issuer identifier is not just "an abstract identifier for the
combination the authorization endpoint and token endpoint".<a href="#section-2.1.2.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="AudienceInjectionCountermeasuresTargetEP">
<section id="section-2.1.2.2">
            <h5 id="name-exact-target-endpoint-uri">
<a href="#section-2.1.2.2" class="section-number selfRef">2.1.2.2. </a><a href="#name-exact-target-endpoint-uri" class="section-name selfRef">Exact Target Endpoint URI</a>
            </h5>
<p id="section-2.1.2.2-1">Clients <span class="bcp14">MUST</span> use the exact endpoint URI to which a client assertion is
sent as that client assertion's sole audience value.<a href="#section-2.1.2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.1.2.2-2">This countermeasure can be used for authorization servers that do not
use authorization server metadata <span>[<a href="#RFC8414" class="cite xref">RFC8414</a>]</span> or OpenID Discovery
<span>[<a href="#OpenID.Discovery" class="cite xref">OpenID.Discovery</a>]</span>.<a href="#section-2.1.2.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="COAT">
<section id="section-2.2">
        <h3 id="name-cross-tool-oauth-account-ta">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-cross-tool-oauth-account-ta" class="section-name selfRef">Cross-tool OAuth Account Takeover</a>
        </h3>
<p id="section-2.2-1">It is increasingly common and observed that a single OAuth client supports multiple tools, and each of which is mapped to an OAuth provider configuration (which includes at least the authorization server (AS) endpoints and client registration). A successful OAuth connection is established when the OAuth client obtains an access token for a tool based on its corresponding OAuth provider configuration. The tool can then use the access token to access the user's resource at a resource server (RS).<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2-2">Multiple OAuth connections can be linked to some form of user's identity based on these common deployment scenarios:<a href="#section-2.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2-3.1">
            <p id="section-2.2-3.1.1">Platform Integrations: The OAuth connections made with different tools are linked to a platform's user account or session (e.g., represented by a platform's user identifier or a short-lived anonymous session). This is common where a user authorizes a platform (e.g., agentic AI service) to orchestrate multiple tools, of which some of them together with their OAuth providers can be contributed by the public.<a href="#section-2.2-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.2-3.2">
            <p id="section-2.2-3.2.1">Multi-tenant OAuth-as-a-Service (OaaS): In cases when the OAuth client is managed by a multi-tenant OAuth-as-a-Service provider, a successful OAuth connection is linked to a tenant's user identifier in addition to the tenant identifier. This is a generalization of the last deployment scenario, where a platform using this OAuth-as-a-Service is becoming a tenant. A tenant can usually choose some off-the-shelf tools using (partially-)completed OAuth providers, if not adding their own with custom OAuth providers to support the tenant's service.<a href="#section-2.2-3.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-2.2-4">When controlled by an attacker, the open configurations of OAuth providers have posed a new threat to this centralized OAuth client design. If the client fails to properly identify, track, and isolate which proper OAuth connection context (representing a combination of OAuth provider, tool, and tenant) is in use during an authorization flow, an attacker can exploit this to mount the Cross-tool OAuth Account Takeover (COAT) attacks (see <span>[<a href="#research.cuhk" class="cite xref">research.cuhk</a>]</span> and <span>[<a href="#research.cuhk3" class="cite xref">research.cuhk3</a>]</span>). The COAT attacker uses a malicious tool to steal a victim's authorization code issued by an honest OAuth provider of an honest tool, and apply the authorization code injection (as defined in <span><a href="https://rfc-editor.org/rfc/rfc9700#section-4.5" class="relref">Section 4.5</a> of [<a href="#RFC9700" class="cite xref">RFC9700</a>]</span>) against a new OAuth connection with the attacker's identity. This results in a compromised OAuth connection between the attacker's platform identity and the victim's tool account. The impact is equivalent to an account takeover: the attacker can operate the honest tool using the victim's tool account (hijacked either under the same platform, or even cross-tenant that shares a vulnerable OAuth-as-a-service).<a href="#section-2.2-4" class="pilcrow">¶</a></p>
<div id="COATDescription">
<section id="section-2.2.1">
          <h4 id="name-attack-description-2">
<a href="#section-2.2.1" class="section-number selfRef">2.2.1. </a><a href="#name-attack-description-2" class="section-name selfRef">Attack Description</a>
          </h4>
<p id="section-2.2.1-1">Preconditions: It is assumed that<a href="#section-2.2.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.1-2.1">
              <p id="section-2.2.1-2.1.1">the implicit or authorization code grant is used with multiple OAuth connection contexts, of which one combination is considered "honest" (H-Tool using H-AuthProvider with H-AS) and one is operated by the attacker (A-Tool using A-AuthProvider with A-AS), and<a href="#section-2.2.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.1-2.2">
              <p id="section-2.2.1-2.2.1">the client stores the connection context chosen by the user in a session bound to the user's browser, and<a href="#section-2.2.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.1-2.3">
              <p id="section-2.2.1-2.3.1">the client issues redirection URIs which do not depend on all variables in the connection context (e.g., auth provider, tool, tenant), and<a href="#section-2.2.1-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.1-2.4">
              <p id="section-2.2.1-2.4.1">the authorization servers properly check the redirection URI by enforcing exact redirection URI matching (otherwise, see Cross Social-Network Request Forgery in <span>[<a href="#research.jcs_14" class="cite xref">research.jcs_14</a>]</span> for details).<a href="#section-2.2.1-2.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-2.2.1-3">In the following, it is further assumed that the client is registered with H-AS (URI: <code>https://honest.as.example</code>, client ID: <code>7ZGZldHQ</code>) and with A-AS (URI: <code>https://attacker.example</code>, client ID: <code>666RVZJTA</code>). Assume that the client issues the redirection URI <code>https://client.com/honest-cb</code> for the honest tool and <code>https://client.com/attack-cb</code> for the attacker's. URLs shown in the following example are shortened for presentation to include only parameters relevant to the attack.<a href="#section-2.2.1-3" class="pilcrow">¶</a></p>
<p id="section-2.2.1-4">Attack on the authorization code grant:<a href="#section-2.2.1-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.2.1-5">
<li id="section-2.2.1-5.1">
              <p id="section-2.2.1-5.1.1">A victim user selects to start the grant using A-AS of A-Tool (e.g., by initiating a tool use on an agentic AI service).<a href="#section-2.2.1-5.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.2.1-5.2">
              <p id="section-2.2.1-5.2.1">The client stores in the user's session that the user has selected such OAuth connection context and redirects the user to A-AS's authorization endpoint with a Location header containing the URL <code>https://attacker.example/authorize?response_type=code&amp;client_id=666RVZJTA&amp;state=[state]</code>
                <code>&amp;redirect_uri=https%3A%2F%2Fclient.com%2Fattack-cb</code>.<a href="#section-2.2.1-5.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.2.1-5.3">
              <p id="section-2.2.1-5.3.1">When the user's browser navigates to the A-AS, the attacker immediately redirects the browser to the authorization endpoint of H-AS. In the authorization request, the attacker uses the honest authorization URL and replaces the state with the one freshly received. Therefore, the browser receives a redirection with a Location header pointing to <code>https://honest.as.example/authorize?response_type=code&amp;client_id=7ZGZldHQ&amp;state=[state]</code>
                <code>&amp;redirect_uri=https%3A%2F%2Fclient.com%2Fhonest-cb</code>.<a href="#section-2.2.1-5.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.2.1-5.4">
              <p id="section-2.2.1-5.4.1">Due to implicit or prior approvals, the user might not be prompted for a re-authorization (re-consent). H-AS issues a code and sends it (via the browser) back with the state to the client.<a href="#section-2.2.1-5.4.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.2.1-5.5">
              <p id="section-2.2.1-5.5.1">Since the client still assumes that the code was issued by A-Tool, as stored in the user's session (with state verified), it will try to redeem the code at A-AS's token endpoint.<a href="#section-2.2.1-5.5.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.2.1-5.6">
              <p id="section-2.2.1-5.6.1">The attacker therefore obtains code and can either exchange the code for an access token (for public clients) or perform an authorization code injection attack as described in <span><a href="https://rfc-editor.org/rfc/rfc9700#section-4.5" class="relref">Section 4.5</a> of [<a href="#RFC9700" class="cite xref">RFC9700</a>]</span>.<a href="#section-2.2.1-5.6.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-2.2.1-6">This Cross-tool OAuth Account Takeover (COAT) attack is a generalization of the Cross-app OAuth Account Takeover as defined in <span>[<a href="#research.cuhk" class="cite xref">research.cuhk</a>]</span> and the mix-up attack as defined in <span><a href="https://rfc-editor.org/rfc/rfc9700#section-4.4" class="relref">Section 4.4</a> of [<a href="#RFC9700" class="cite xref">RFC9700</a>]</span>. This COAT exploits confusion between the OAuth connection context (i.e., a combination of OAuth provider, tool, tenant) of a centralized client rather than limited to confusion between two distinct authorization servers.<a href="#section-2.2.1-6" class="pilcrow">¶</a></p>
<p id="section-2.2.1-7">Variants:<a href="#section-2.2.1-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.1-8.1">
              <p id="section-2.2.1-8.1.1">COAT under the OaaS context: the attack above can be launched with a malicious tenant (1) simply using a shared off-the-shelf tool that comes with pre-built OAuth providers (with client registration included), if so allowed; or (2) adding a custom tool with an OAuth provider targeting an honest AS used by another tenant's tool.<a href="#section-2.2.1-8.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.1-8.2">
              <p id="section-2.2.1-8.2.1">Implicit Grant: In the implicit grant, the attacker receives an access token instead of the code in Step 4.  The attacker's authorization server receives the access token when the client makes either a request to the A-AS userinfo endpoint (defined in <span>[<a href="#OpenID.Core" class="cite xref">OpenID.Core</a>]</span>) or a request to the attacker's resource server (since the client believes it has completed the flow with A-AS).<a href="#section-2.2.1-8.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.1-8.3">
              <p id="section-2.2.1-8.3.1">Cross-tool OAuth Request Forgery (CORF): If clients do not store the selected OAuth connection context in the user's session, but in the redirection URI instead, attackers can mount an attack called Cross-tool OAuth Request Forgery (CORF). This results in a compromised OAuth connection between the victim's platform identity and the attacker's tool account. The goal of this specific attack variant is not to obtain an authorization code or access token, but to force the client to use an attacker's authorization code or access token for H-AS. This Cross-tool OAuth Request Forgery attack is a generalization of the Cross-app OAuth Request Forgery as defined in <span>[<a href="#research.cuhk" class="cite xref">research.cuhk</a>]</span> and the Naïve RP Session Integrity Attack when the OAuth connection context is limited to AS, and is detailed in Section 3.4 of <span>[<a href="#arXiv.1601.01229" class="cite xref">arXiv.1601.01229</a>]</span>.<a href="#section-2.2.1-8.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.1-8.4">
              <p id="section-2.2.1-8.4.1">OpenID Connect: Some variants can be used to attack OpenID Connect. In these attacks, the attacker misuses features of the OpenID Connect Discovery <span>[<a href="#OpenID.Discovery" class="cite xref">OpenID.Discovery</a>]</span> mechanism or replays access tokens or ID Tokens to conduct a mix-up attack. The attacks are described in detail in Appendix A of <span>[<a href="#arXiv.1704.08539" class="cite xref">arXiv.1704.08539</a>]</span> and Section 6 of <span>[<a href="#arXiv.1508.04324v2" class="cite xref">arXiv.1508.04324v2</a>]</span> ("Malicious Endpoints Attacks").<a href="#section-2.2.1-8.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="COATCountermeasure">
<section id="section-2.2.2">
          <h4 id="name-countermeasures-2">
<a href="#section-2.2.2" class="section-number selfRef">2.2.2. </a><a href="#name-countermeasures-2" class="section-name selfRef">Countermeasures</a>
          </h4>
<p id="section-2.2.2-1">The client <span class="bcp14">MUST NOT</span> share OAuth providers with completed client registrations across tools and tenants belonging to different owners.<a href="#section-2.2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2.2-2">The client <span class="bcp14">MUST</span> use all variables in its supported OAuth connection context to form a unique connection context identifier, which always includes the unique tool identifier. Additionally,<a href="#section-2.2.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.2-3.1">
              <p id="section-2.2.2-3.1.1">a client allowing each tool to use multiple OAuth providers, of which one AS may get compromised as assumed in <span><a href="https://rfc-editor.org/rfc/rfc9700#section-4.4" class="relref">Section 4.4</a> of [<a href="#RFC9700" class="cite xref">RFC9700</a>]</span>, <span class="bcp14">MUST</span> also include the OAuth provider identifier;<a href="#section-2.2.2-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.2-3.2">
              <p id="section-2.2.2-3.2.1">a cross-tenant client <span class="bcp14">MUST</span> also include the tenant identifier, if the tool identifier is not globally unique.<a href="#section-2.2.2-3.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-2.2.2-4">Unless otherwise specified as follows, the client <span class="bcp14">MUST</span> issue per-context distinct redirection URI that incorporates this unique connection context identifier. When initiating an authorization request, the client <span class="bcp14">MUST</span> store this identifier in the user's session. When an authorization response was received on the redirection URI endpoint, clients <span class="bcp14">MUST</span> also check that the context identifier from the URI matches with the one in the distinct redirection URI. If there is a mismatch, the client <span class="bcp14">MUST</span> abort the flow.<a href="#section-2.2.2-4" class="pilcrow">¶</a></p>
<p id="section-2.2.2-5">Existing mix-up countermeasures <span><a href="https://rfc-editor.org/rfc/rfc9700#section-4.4" class="relref">Section 4.4</a> of [<a href="#RFC9700" class="cite xref">RFC9700</a>]</span> can be a replacement under the following conditions:<a href="#section-2.2.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.2-6.1">
              <p id="section-2.2.2-6.1.1">the client has entirely dropped the support to implicit grant, and<a href="#section-2.2.2-6.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.2-6.2">
              <p id="section-2.2.2-6.2.1">the OAuth provider specifies an AS not by individual AS endpoints but instead replaced with an abstract issuer identifier representing the endpoints, and<a href="#section-2.2.2-6.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.2-6.3">
              <p id="section-2.2.2-6.3.1">the issuer identifier is used either in place of the connection context identifier or is separately returned according to <span>[<a href="#RFC9207" class="cite xref">RFC9207</a>]</span>, and<a href="#section-2.2.2-6.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.2-6.4">
              <p id="section-2.2.2-6.4.1">an additional runtime resolution is used to resolve the issuer to retrieve the associated AS endpoints (e.g., with the authorization server metadata <span>[<a href="#RFC8414" class="cite xref">RFC8414</a>]</span>). Clients using such resolution solely to populate an OAuth provider defined with individual AS endpoints and lack the connection context identifier defense will remain vulnerable.<a href="#section-2.2.2-6.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="SessionFixation">
<section id="section-2.3">
        <h3 id="name-cross-user-oauth-session-fi">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-cross-user-oauth-session-fi" class="section-name selfRef">Cross-user OAuth Session Fixation</a>
        </h3>
<p id="section-2.3-1">Based on similar deployment needs as outlined in <a href="#COAT" class="auto internal xref">Section 2.2</a>, multiple OAuth connections can be linked to some form of user's identity (e.g., a platform's user identifier). This identity information is supposedly maintained in a session established and already bound to the user agent. In real-world deployments, however, this prerequisite can be broken for various reasons. For instance, in cross-user-agent OAuth deployments, where an authenticated native app with its backend acting as a confidential OAuth client, the client opens a tool linking URL in an external user agent (a browser) that has no authenticated sessions with the client. As a workaround, the client introduces a session fixation vulnerability: it encodes a session identifier into the URL, which fixates a dedicated authorization session to complete the OAuth connection with the user at the client.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<p id="section-2.3-2">The Cross-user OAuth Session Fixation exploits this session fixation attack vector. The attacker attempts to trick a victim into completing an OAuth flow that the attacker has initiated at the client. As a result, the attacker's session will be used to establish an OAuth connection with the victim's tool resources or identity, hence resulting in the same impact of COAT. However, this attack exploits confusion over the intended user bound to that connection context during the OAuth flow, contrasting with COAT, which exploits confusion within the OAuth connection context (OAuth provider, tool, tenant).<a href="#section-2.3-2" class="pilcrow">¶</a></p>
<p id="section-2.3-3">In general, this session fixation vulnerability may be viewed as violating the requirement of "binding the contents of state to the browser (more precisely, the initiating user agent) session" to defend against CSRF (<span><a href="https://rfc-editor.org/rfc/rfc9700#section-4.7" class="relref">Section 4.7</a> of [<a href="#RFC9700" class="cite xref">RFC9700</a>]</span>). However, CSRF defenses, including PKCE <span>[<a href="#RFC7636" class="cite xref">RFC7636</a>]</span>, cannot mitigate this new attack, since the entire OAuth flow including the authorization request and the access token request are completed by the same victim user. The impact of the new attack is also more severe from that of typical CSRF attacks.<a href="#section-2.3-3" class="pilcrow">¶</a></p>
<p id="section-2.3-4">Note that this section focuses on the authorization code grant. For similar attacks in cross-device OAuth flows, see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-oauth-cross-device-security-12#section-4" class="relref">Section 4</a> of [<a href="#CDFS" class="cite xref">CDFS</a>]</span>.<a href="#section-2.3-4" class="pilcrow">¶</a></p>
<div id="FixationAttack">
<section id="section-2.3.1">
          <h4 id="name-attack-description-3">
<a href="#section-2.3.1" class="section-number selfRef">2.3.1. </a><a href="#name-attack-description-3" class="section-name selfRef">Attack Description</a>
          </h4>
<p id="section-2.3.1-1">Preconditions: It is assumed that the client has maintained a user's session. But it does not want to or cannot authenticate the user at the redirection endpoint for usability reasons, before completing the OAuth connection.<a href="#section-2.3.1-1" class="pilcrow">¶</a></p>
<p id="section-2.3.1-2">Example Attack:<a href="#section-2.3.1-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.3.1-3">
<li id="section-2.3.1-3.1">
              <p id="section-2.3.1-3.1.1">From a vulnerable client, the attacker initiates OAuth against a tool and obtains an authorization request URL, in which the <code>state</code> has encoded a newly fixable authorization session of the attacker.<a href="#section-2.3.1-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.3.1-3.2">
              <p id="section-2.3.1-3.2.1">The attacker sends this authorization request URL to a victim.<a href="#section-2.3.1-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.3.1-3.3">
              <p id="section-2.3.1-3.3.1">The victim visits the URL and (automatically, due to prior or implicit approvals,) authorizes the client to access their resources.<a href="#section-2.3.1-3.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.3.1-3.4">
              <p id="section-2.3.1-3.4.1">Upon receiving the <code>state</code> at the redirection endpoint, the client fixates the attacker's authorization session and completes the OAuth connection.<a href="#section-2.3.1-3.4.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.3.1-3.5">
              <p id="section-2.3.1-3.5.1">The attacker's account at the client now gains access to the victim's resources.<a href="#section-2.3.1-3.5.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-2.3.1-4">Variant:<a href="#section-2.3.1-4" class="pilcrow">¶</a></p>
<p id="section-2.3.1-5">The client may first generate a pre-authorization URL for the purpose of fixating a session before redirecting to the authorization endpoint.<a href="#section-2.3.1-5" class="pilcrow">¶</a></p>
<p id="section-2.3.1-6">Non-normative example request:<a href="#section-2.3.1-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.3.1-7">
<pre>
GET /oauth?auth_session_id=6064f11c-f73e-425b-b9b9-4a36088cdb2b HTTP/1.1
Host: client.com
</pre><a href="#section-2.3.1-7" class="pilcrow">¶</a>
</div>
<p id="section-2.3.1-8">Non-normative example response:<a href="#section-2.3.1-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.3.1-9">
<pre>
HTTP/1.1 303 See Other
Location: https://as.example/authorize?
          response_type=code&amp;client_id=K9dTpWzqL7&amp;state=b1d8f043
          &amp;redirect_uri=https%3A%2F%2Fclient.com%2Fcb
Set-Cookie: auth_session_id=6064f11c-f73e-425b-b9b9-4a36088cdb2b
</pre><a href="#section-2.3.1-9" class="pilcrow">¶</a>
</div>
<p id="section-2.3.1-10">This attack differs from the above only by obtaining and using the pre-authorization URL instead, which will first fixate the attacker's authorization session (rather than in Step 4).<a href="#section-2.3.1-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="FixationCountermeasures">
<section id="section-2.3.2">
          <h4 id="name-countermeasures-3">
<a href="#section-2.3.2" class="section-number selfRef">2.3.2. </a><a href="#name-countermeasures-3" class="section-name selfRef">Countermeasures</a>
          </h4>
<p id="section-2.3.2-1">Defending against the Cross-user OAuth Session Fixation attack requires ensuring that an OAuth connection flow initiated by one user <span class="bcp14">MUST</span> only be completed by the same user.<a href="#section-2.3.2-1" class="pilcrow">¶</a></p>
<p id="section-2.3.2-2">The most straightforward countermeasure is to re-authenticate the user instead of trying to fixate a session if usability condition permits. It is also understandable that the session fixation vector cannot be eliminated due to application needs. For instance, the client's user session and the OAuth client responsible for making OAuth connections are handled by separate entities (e.g., separate services hosted and isolated under different origins, or when the OAuth client is outsourced to an OAuth-as-a-Service provider), as observed in practice by <span>[<a href="#research.cuhk2" class="cite xref">research.cuhk2</a>]</span> and <span>[<a href="#research.cuhk3" class="cite xref">research.cuhk3</a>]</span>.<a href="#section-2.3.2-2" class="pilcrow">¶</a></p>
<p id="section-2.3.2-3">Hence, the client <span class="bcp14">MUST</span> bind any <em>newly fixated session</em> (conveyed via state or the preauthorization URL during an OAuth flow to establish the OAuth connection) with the <em>existing session</em> (maintained at the user agent) which initiates the OAuth flow, before proceeding with the access token request. Depending on the specific current settings:<a href="#section-2.3.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.3.2-4.1">
              <p id="section-2.3.2-4.1.1">When the endpoint with existing user session and the redirection endpoint are hosted in the same origin and same user agent, the client <span class="bcp14">MUST</span> validate the binding between the newly fixated session and the existing session before the access token request.<a href="#section-2.3.2-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.3.2-4.2">
              <p id="section-2.3.2-4.2.1">In case the redirection endpoint is hosted elsewhere (a different origin or user agent), the countermeasure requires:<a href="#section-2.3.2-4.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.3.2-4.2.2.1">
                  <p id="section-2.3.2-4.2.2.1.1">an implementation change to co-locate the endpoint with user session and the redirection endpoint in the same origin and user agent (see above), or<a href="#section-2.3.2-4.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-2.3.2-4.2.2.2">
                  <p id="section-2.3.2-4.2.2.2.1">at the current redirection endpoint, further redirect, using HTTP Location or native app redirection as detailed in <span><a href="https://rfc-editor.org/rfc/rfc8252#section-7" class="relref">Section 7</a> of [<a href="#RFC8252" class="cite xref">RFC8252</a>]</span>, back to (the starting origin and/or user agent) where the existing session is available. The location of this further redirection <span class="bcp14">MUST NOT</span> be controllable by an attacker, or it will result in Open Redirection (<span><a href="https://rfc-editor.org/rfc/rfc9700#section-4.11" class="relref">Section 4.11</a> of [<a href="#RFC9700" class="cite xref">RFC9700</a>]</span>). The client <span class="bcp14">MUST</span> validate the binding between the sessions before the access token request.<a href="#section-2.3.2-4.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="Security">
<section id="section-3">
      <h2 id="name-security-considerations">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-3-1">Security considerations are described in <a href="#AttacksMitigations" class="auto internal xref">Section 2</a>.<a href="#section-3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="IANA">
<section id="section-4">
      <h2 id="name-iana-considerations">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-4-1">This document has no IANA actions.<a href="#section-4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-combined-references">
<section id="section-5">
      <h2 id="name-references">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-5.1">
        <h3 id="name-normative-references">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6749">[RFC6749]</dt>
        <dd>
<span class="refAuthor">Hardt, D., Ed.</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework"</span>, <span class="seriesInfo">RFC 6749</span>, <span class="seriesInfo">DOI 10.17487/RFC6749</span>, <time datetime="2012-10" class="refDate">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6749">https://www.rfc-editor.org/rfc/rfc6749</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7521">[RFC7521]</dt>
        <dd>
<span class="refAuthor">Campbell, B.</span>, <span class="refAuthor">Mortimore, C.</span>, <span class="refAuthor">Jones, M.</span>, and <span class="refAuthor">Y. Goland</span>, <span class="refTitle">"Assertion Framework for OAuth 2.0 Client Authentication and Authorization Grants"</span>, <span class="seriesInfo">RFC 7521</span>, <span class="seriesInfo">DOI 10.17487/RFC7521</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7521">https://www.rfc-editor.org/rfc/rfc7521</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7523">[RFC7523]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Campbell, B.</span>, and <span class="refAuthor">C. Mortimore</span>, <span class="refTitle">"JSON Web Token (JWT) Profile for OAuth 2.0 Client Authentication and Authorization Grants"</span>, <span class="seriesInfo">RFC 7523</span>, <span class="seriesInfo">DOI 10.17487/RFC7523</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7523">https://www.rfc-editor.org/rfc/rfc7523</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8252">[RFC8252]</dt>
        <dd>
<span class="refAuthor">Denniss, W.</span> and <span class="refAuthor">J. Bradley</span>, <span class="refTitle">"OAuth 2.0 for Native Apps"</span>, <span class="seriesInfo">BCP 212</span>, <span class="seriesInfo">RFC 8252</span>, <span class="seriesInfo">DOI 10.17487/RFC8252</span>, <time datetime="2017-10" class="refDate">October 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8252">https://www.rfc-editor.org/rfc/rfc8252</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8414">[RFC8414]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Sakimura, N.</span>, and <span class="refAuthor">J. Bradley</span>, <span class="refTitle">"OAuth 2.0 Authorization Server Metadata"</span>, <span class="seriesInfo">RFC 8414</span>, <span class="seriesInfo">DOI 10.17487/RFC8414</span>, <time datetime="2018-06" class="refDate">June 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8414">https://www.rfc-editor.org/rfc/rfc8414</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9700">[RFC9700]</dt>
      <dd>
<span class="refAuthor">Lodderstedt, T.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Labunets, A.</span>, and <span class="refAuthor">D. Fett</span>, <span class="refTitle">"Best Current Practice for OAuth 2.0 Security"</span>, <span class="seriesInfo">BCP 240</span>, <span class="seriesInfo">RFC 9700</span>, <span class="seriesInfo">DOI 10.17487/RFC9700</span>, <time datetime="2025-01" class="refDate">January 2025</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9700">https://www.rfc-editor.org/rfc/rfc9700</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-5.2">
        <h3 id="name-informative-references">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="arXiv.1508.04324v2">[arXiv.1508.04324v2]</dt>
        <dd>
<span class="refAuthor">Mladenov, V.</span>, <span class="refAuthor">Mainka, C.</span>, and <span class="refAuthor">J. Schwenk</span>, <span class="refTitle">"On the security of modern Single Sign-On Protocols: Second-Order Vulnerabilities in OpenID Connect"</span>, <span class="refContent">arXiv:1508.04324v2</span>, <time datetime="2016-01" class="refDate">January 2016</time>, <span>&lt;<a href="https://arxiv.org/abs/1508.04324v2/">https://arxiv.org/abs/1508.04324v2/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="arXiv.1601.01229">[arXiv.1601.01229]</dt>
        <dd>
<span class="refAuthor">Fett, D.</span>, <span class="refAuthor">Küsters, R.</span>, and <span class="refAuthor">G. Schmitz</span>, <span class="refTitle">"A Comprehensive Formal Security Analysis of OAuth 2.0"</span>, <span class="refContent">arXiv:1601.01229</span>, <time datetime="2016-01" class="refDate">January 2016</time>, <span>&lt;<a href="https://arxiv.org/abs/1601.01229/">https://arxiv.org/abs/1601.01229/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="arXiv.1704.08539">[arXiv.1704.08539]</dt>
        <dd>
<span class="refAuthor">Fett, D.</span>, <span class="refAuthor">Küsters, R.</span>, and <span class="refAuthor">G. Schmitz</span>, <span class="refTitle">"The Web SSO Standard OpenID Connect: In-Depth Formal Security Analysis and Security Guidelines"</span>, <span class="refContent">arXiv:1704.08539</span>, <time datetime="2017-04" class="refDate">April 2017</time>, <span>&lt;<a href="https://arxiv.org/abs/1704.08539/">https://arxiv.org/abs/1704.08539/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CDFS">[CDFS]</dt>
        <dd>
<span class="refAuthor">Kasselman, P.</span>, <span class="refAuthor">Fett, D.</span>, and <span class="refAuthor">F. Skokan</span>, <span class="refTitle">"Cross-Device Flows: Security Best Current Practice"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-oauth-cross-device-security-12</span>, <time datetime="2025-09-05" class="refDate">5 September 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-oauth-cross-device-security-12">https://datatracker.ietf.org/doc/html/draft-ietf-oauth-cross-device-security-12</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="MCP-Spec">[MCP-Spec]</dt>
        <dd>
<span class="refAuthor">Anthropic</span>, <span class="refTitle">"Model Context Protocol (MCP) Specification"</span>, <time datetime="2025-06" class="refDate">June 2025</time>, <span>&lt;<a href="https://modelcontextprotocol.io/specification/2025-06-18">https://modelcontextprotocol.io/specification/2025-06-18</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OAUTH-7523bis">[OAUTH-7523bis]</dt>
        <dd>
<span class="refAuthor">Jones, M. B.</span>, <span class="refAuthor">Campbell, B.</span>, and <span class="refAuthor">C. Mortimore</span>, <span class="refTitle">"JSON Web Token (JWT) Profile for OAuth 2.0 Client Authentication and Authorization Grants"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-oauth-rfc7523bis-00</span>, <time datetime="2025-02-21" class="refDate">21 February 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-oauth-rfc7523bis-00">https://datatracker.ietf.org/doc/html/draft-ietf-oauth-rfc7523bis-00</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OpenID.CIBA">[OpenID.CIBA]</dt>
        <dd>
<span class="refAuthor">Fernandez, G.</span>, <span class="refAuthor">Walter, F.</span>, <span class="refAuthor">Nennker, A.</span>, <span class="refAuthor">Tonge, D.</span>, and <span class="refAuthor">B. Campbell</span>, <span class="refTitle">"OpenID Connect Client-Initiated Backchannel Authentication Flow - Core 1.0"</span>, <time datetime="2021-09" class="refDate">September 2021</time>, <span>&lt;<a href="https://openid.net/specs/openid-client-initiated-backchannel-authentication-core-1_0.html">https://openid.net/specs/openid-client-initiated-backchannel-authentication-core-1_0.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OpenID.Core">[OpenID.Core]</dt>
        <dd>
<span class="refAuthor">Sakimura, N.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Jones, M.</span>, <span class="refAuthor">de Medeiros, B.</span>, and <span class="refAuthor">C. Mortimore</span>, <span class="refTitle">"OpenID Connect Core 1.0 incorporating errata set 2"</span>, <time datetime="2023-12" class="refDate">December 2023</time>, <span>&lt;<a href="https://openid.net/specs/openid-connect-core-1_0.html">https://openid.net/specs/openid-connect-core-1_0.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OpenID.Discovery">[OpenID.Discovery]</dt>
        <dd>
<span class="refAuthor">Sakimura, N.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Jones, M.</span>, and <span class="refAuthor">E. Jay</span>, <span class="refTitle">"OpenID Connect Discovery 1.0 incorporating errata set 2"</span>, <time datetime="2023-12" class="refDate">December 2023</time>, <span>&lt;<a href="https://openid.net/specs/openid-connect-discovery-1_0.html">https://openid.net/specs/openid-connect-discovery-1_0.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="research.cuhk">[research.cuhk]</dt>
        <dd>
<span class="refAuthor">Luo, K.</span>, <span class="refAuthor">Wang, X.</span>, <span class="refAuthor">Fung, P. H. A.</span>, <span class="refAuthor">Lau, W. C.</span>, and <span class="refAuthor">J. Lecomte</span>, <span class="refTitle">"Universal Cross-app Attacks: Exploiting and Securing OAuth 2.0 in Integration Platforms"</span>, <span class="refContent">34th USENIX Security Symposium (USENIX Security 25)</span>, <time datetime="2025-08" class="refDate">August 2025</time>, <span>&lt;<a href="https://www.usenix.org/system/files/usenixsecurity25-luo-kaixuan.pdf">https://www.usenix.org/system/files/usenixsecurity25-luo-kaixuan.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="research.cuhk2">[research.cuhk2]</dt>
        <dd>
<span class="refAuthor">Luo, K.</span>, <span class="refAuthor">Wang, X.</span>, <span class="refAuthor">Fung, A.</span>, <span class="refAuthor">Lecomte, J.</span>, and <span class="refAuthor">W. C. Lau</span>, <span class="refTitle">"One Hack to Rule Them All: Pervasive Account Takeovers in Integration Platforms for Workflow Automation, Virtual Voice Assistant, IoT, &amp; LLM Services"</span>, <span class="refContent">Black Hat USA 2024</span>, <time datetime="2024-08" class="refDate">August 2024</time>, <span>&lt;<a href="https://www.blackhat.com/us-24/briefings/schedule/#one-hack-to-rule-them-all-pervasive-account-takeovers-in-integration-platforms-for-workflow-automation-virtual-voice-assistant-iot-38-llm-services-38994">https://www.blackhat.com/us-24/briefings/schedule/#one-hack-to-rule-them-all-pervasive-account-takeovers-in-integration-platforms-for-workflow-automation-virtual-voice-assistant-iot-38-llm-services-38994</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="research.cuhk3">[research.cuhk3]</dt>
        <dd>
<span class="refAuthor">Luo, K.</span>, <span class="refAuthor">Wang, X.</span>, <span class="refAuthor">Fung, A.</span>, <span class="refAuthor">Bi, Y.</span>, and <span class="refAuthor">W. C. Lau</span>, <span class="refTitle">"Back to the Future: Hacking and Securing Connection-based OAuth Architectures in Agentic AI and Integration Platforms"</span>, <span class="refContent">Black Hat USA 2025</span>, <time datetime="2025-08" class="refDate">August 2025</time>, <span>&lt;<a href="https://www.blackhat.com/us-25/briefings/schedule/index.html#back-to-the-future-hacking-and-securing-connection-based-oauth-architectures-in-agentic-ai-and-integration-platforms-44686">https://www.blackhat.com/us-25/briefings/schedule/index.html#back-to-the-future-hacking-and-securing-connection-based-oauth-architectures-in-agentic-ai-and-integration-platforms-44686</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="research.jcs_14">[research.jcs_14]</dt>
        <dd>
<span class="refAuthor">Bansal, C.</span>, <span class="refAuthor">Bhargavan, K.</span>, <span class="refAuthor">Delignat-Lavaud, A.</span>, and <span class="refAuthor">S. Maffeis</span>, <span class="refTitle">"Discovering concrete attacks on website authorization by formal analysis"</span>, <span class="refContent">Journal of Computer Security, vol. 22, no. 4, pp. 601-657</span>, <time datetime="2014-04" class="refDate">April 2014</time>, <span>&lt;<a href="https://www.doc.ic.ac.uk/~maffeis/papers/jcs14.pdf">https://www.doc.ic.ac.uk/~maffeis/papers/jcs14.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="research.ust">[research.ust]</dt>
        <dd>
<span class="refAuthor">Hosseyni, P.</span>, <span class="refAuthor">Küsters, R.</span>, and <span class="refAuthor">T. Würtele</span>, <span class="refTitle">"Audience Injection Attacks: A New Class of Attacks on Web-Based Authorization and Authentication Standards"</span>, <time datetime="2025-04" class="refDate">April 2025</time>, <span>&lt;<a href="https://eprint.iacr.org/2025/629">https://eprint.iacr.org/2025/629</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7009">[RFC7009]</dt>
        <dd>
<span class="refAuthor">Lodderstedt, T., Ed.</span>, <span class="refAuthor">Dronia, S.</span>, and <span class="refAuthor">M. Scurtescu</span>, <span class="refTitle">"OAuth 2.0 Token Revocation"</span>, <span class="seriesInfo">RFC 7009</span>, <span class="seriesInfo">DOI 10.17487/RFC7009</span>, <time datetime="2013-08" class="refDate">August 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7009">https://www.rfc-editor.org/rfc/rfc7009</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7519">[RFC7519]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Sakimura</span>, <span class="refTitle">"JSON Web Token (JWT)"</span>, <span class="seriesInfo">RFC 7519</span>, <span class="seriesInfo">DOI 10.17487/RFC7519</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7519">https://www.rfc-editor.org/rfc/rfc7519</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7522">[RFC7522]</dt>
        <dd>
<span class="refAuthor">Campbell, B.</span>, <span class="refAuthor">Mortimore, C.</span>, and <span class="refAuthor">M. Jones</span>, <span class="refTitle">"Security Assertion Markup Language (SAML) 2.0 Profile for OAuth 2.0 Client Authentication and Authorization Grants"</span>, <span class="seriesInfo">RFC 7522</span>, <span class="seriesInfo">DOI 10.17487/RFC7522</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7522">https://www.rfc-editor.org/rfc/rfc7522</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7636">[RFC7636]</dt>
        <dd>
<span class="refAuthor">Sakimura, N., Ed.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Agarwal</span>, <span class="refTitle">"Proof Key for Code Exchange by OAuth Public Clients"</span>, <span class="seriesInfo">RFC 7636</span>, <span class="seriesInfo">DOI 10.17487/RFC7636</span>, <time datetime="2015-09" class="refDate">September 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7636">https://www.rfc-editor.org/rfc/rfc7636</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8628">[RFC8628]</dt>
        <dd>
<span class="refAuthor">Denniss, W.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Jones, M.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"OAuth 2.0 Device Authorization Grant"</span>, <span class="seriesInfo">RFC 8628</span>, <span class="seriesInfo">DOI 10.17487/RFC8628</span>, <time datetime="2019-08" class="refDate">August 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8628">https://www.rfc-editor.org/rfc/rfc8628</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9126">[RFC9126]</dt>
        <dd>
<span class="refAuthor">Lodderstedt, T.</span>, <span class="refAuthor">Campbell, B.</span>, <span class="refAuthor">Sakimura, N.</span>, <span class="refAuthor">Tonge, D.</span>, and <span class="refAuthor">F. Skokan</span>, <span class="refTitle">"OAuth 2.0 Pushed Authorization Requests"</span>, <span class="seriesInfo">RFC 9126</span>, <span class="seriesInfo">DOI 10.17487/RFC9126</span>, <time datetime="2021-09" class="refDate">September 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9126">https://www.rfc-editor.org/rfc/rfc9126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9207">[RFC9207]</dt>
      <dd>
<span class="refAuthor">Meyer zu Selhausen, K.</span> and <span class="refAuthor">D. Fett</span>, <span class="refTitle">"OAuth 2.0 Authorization Server Issuer Identification"</span>, <span class="seriesInfo">RFC 9207</span>, <span class="seriesInfo">DOI 10.17487/RFC9207</span>, <time datetime="2022-03" class="refDate">March 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9207">https://www.rfc-editor.org/rfc/rfc9207</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="Acknowledgements">
<section id="appendix-A">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-A-1">We would like to thank
<span class="cref" id="acksAddNames">TODO add names, sort by last name.<span class="crefSource">Tim W.</span></span>
Daniel Fett,
Wing Cheong Lau,
Julien Lecomte,
Aaron Parecki,
Guido Schmitz, and
Xianbo Wang<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2">for their valuable feedback and contributions to this document.<a href="#appendix-A-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="document-history">
<section id="appendix-B">
      <h2 id="name-document-history">
<a href="#name-document-history" class="section-name selfRef">Document History</a>
      </h2>
<p id="appendix-B-1">[[ To be removed from the final specification ]]<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">-02<a href="#appendix-B-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-3.1">
          <p id="appendix-B-3.1.1">Rewrote Mix-up related sections<a href="#appendix-B-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-3.2">
          <p id="appendix-B-3.2.1">Added section on Session Fixation attack<a href="#appendix-B-3.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-B-4">-01<a href="#appendix-B-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-5.1">
          <p id="appendix-B-5.1.1">Updated temporary title<a href="#appendix-B-5.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-5.2">
          <p id="appendix-B-5.2.1">Added introductory paragraphs, replaced placeholders<a href="#appendix-B-5.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-5.3">
          <p id="appendix-B-5.3.1">Clarified issuer does not uniquely identify client config<a href="#appendix-B-5.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-5.4">
          <p id="appendix-B-5.4.1">Cleaned up acknowledgement list<a href="#appendix-B-5.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-B-6">-00<a href="#appendix-B-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-7.1">
          <p id="appendix-B-7.1.1">Initial version<a href="#appendix-B-7.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Tim Würtele</span></div>
<div dir="auto" class="left"><span class="org">University of Stuttgart</span></div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:tim.wuertele@sec.uni-stuttgart.de" class="email">tim.wuertele@sec.uni-stuttgart.de</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Pedram Hosseyni</span></div>
<div dir="auto" class="left"><span class="org">University of Stuttgart</span></div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:pedram.hosseyni@sec.uni-stuttgart.de" class="email">pedram.hosseyni@sec.uni-stuttgart.de</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Kaixuan Luo</span></div>
<div dir="auto" class="left"><span class="org">The Chinese University of Hong Kong</span></div>
<div dir="auto" class="left"><span class="country-name">Hong Kong</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:kaixuan@ie.cuhk.edu.hk" class="email">kaixuan@ie.cuhk.edu.hk</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Adonis Fung</span></div>
<div dir="auto" class="left"><span class="org">Samsung Research America</span></div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:adonis.fung@samsung.com" class="email">adonis.fung@samsung.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
