<!DOCTYPE html>
<html lang="en" class="Internet-Draft bcp">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Updates to OAuth 2.0 Security Best Current Practice</title>
<meta content="Tim Würtele" name="author">
<meta content="Pedram Hosseyni" name="author">
<meta content="Kaixuan Luo" name="author">
<meta content="Adonis Fung" name="author">
<meta content="
       This document updates the set of best current security practices for
OAuth 2.0 by extending the security advice given in RFC 6749, RFC
6750, and RFC 9700, to cover new threats that have been discovered
since the former documents have been published. 
    " name="description">
<meta content="xml2rfc 3.28.1" name="generator">
<meta content="security" name="keyword">
<meta content="oauth2" name="keyword">
<meta content="best current practice" name="keyword">
<meta content="draft-wuertele-oauth-security-topics-update-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.28.1
    Python 3.12.11
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.6
    lxml 5.3.1
    platformdirs 4.3.8
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.4
    setuptools 80.9.0
    wcwidth 0.2.13
-->
<link href="draft-wuertele-oauth-security-topics-update.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Updates to OAuth 2.0 Security BCP</td>
<td class="right">June 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Würtele, et al.</td>
<td class="center">Expires 19 December 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Web Authorization Protocol</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-wuertele-oauth-security-topics-update-latest</dd>
<dt class="label-bcp">bcp:</dt>
<dd class="bcp">240</dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a href="https://www.rfc-editor.org/rfc/rfc6749" class="eref">6749</a>, <a href="https://www.rfc-editor.org/rfc/rfc6750" class="eref">6750</a>, <a href="https://www.rfc-editor.org/rfc/rfc7521" class="eref">7521</a>, <a href="https://www.rfc-editor.org/rfc/rfc7522" class="eref">7522</a>, <a href="https://www.rfc-editor.org/rfc/rfc7523" class="eref">7523</a>, <a href="https://www.rfc-editor.org/rfc/rfc9700" class="eref">9700</a> (if approved)</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-06-17" class="published">17 June 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Best Current Practice</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-12-19">19 December 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">T. Würtele</div>
<div class="org">University of Stuttgart</div>
</div>
<div class="author">
      <div class="author-name">P. Hosseyni</div>
<div class="org">University of Stuttgart</div>
</div>
<div class="author">
      <div class="author-name">K. Luo</div>
<div class="org">The Chinese University of Hong Kong</div>
</div>
<div class="author">
      <div class="author-name">A. Fung</div>
<div class="org">Samsung Research America</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Updates to OAuth 2.0 Security Best Current Practice</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document updates the set of best current security practices for
OAuth 2.0 by extending the security advice given in RFC 6749, RFC
6750, and RFC 9700, to cover new threats that have been discovered
since the former documents have been published.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://SECtim.github.io/draft-wuertele-oauth-security-topics-update/draft-wuertele-oauth-security-topics-update.html">https://SECtim.github.io/draft-wuertele-oauth-security-topics-update/draft-wuertele-oauth-security-topics-update.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-wuertele-oauth-security-topics-update/">https://datatracker.ietf.org/doc/draft-wuertele-oauth-security-topics-update/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        Web Authorization Protocol  mailing list (<span><a href="mailto:oauth@ietf.org">mailto:oauth@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/oauth/">https://mailarchive.ietf.org/arch/browse/oauth/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/oauth/">https://www.ietf.org/mailman/listinfo/oauth/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/SECtim/draft-wuertele-oauth-security-topics-update">https://github.com/SECtim/draft-wuertele-oauth-security-topics-update</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 19 December 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-structure" class="internal xref">Structure</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-conventions-and-terminology" class="internal xref">Conventions and Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-attacks-and-mitigations" class="internal xref">Attacks and Mitigations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-audience-injection-attacks" class="internal xref">Audience Injection Attacks</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.1">
                    <p id="section-toc.1-1.2.2.1.2.1.1"><a href="#section-2.1.1" class="auto internal xref">2.1.1</a>.  <a href="#name-attack-description" class="internal xref">Attack Description</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.2">
                    <p id="section-toc.1-1.2.2.1.2.2.1"><a href="#section-2.1.2" class="auto internal xref">2.1.2</a>.  <a href="#name-countermeasures" class="internal xref">Countermeasures</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-updates-to-mix-up-attacks" class="internal xref">Updates to Mix-Up Attacks</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.1">
                    <p id="section-toc.1-1.2.2.2.2.1.1"><a href="#section-2.2.1" class="auto internal xref">2.2.1</a>.  <a href="#name-updates-to-per-as-redirect-" class="internal xref">Updates to "Per-AS Redirect URIs" Mix-Up Variant</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.2">
                    <p id="section-toc.1-1.2.2.2.2.2.1"><a href="#section-2.2.2" class="auto internal xref">2.2.2</a>.  <a href="#name-clarifications-on-counterme" class="internal xref">Clarifications on Countermeasures for Mix-Up Variants</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="auto internal xref">2.3</a>.  <a href="#name-attacks-in-open-ecosystems" class="internal xref">Attacks in Open Ecosystems</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.1">
                    <p id="section-toc.1-1.2.2.3.2.1.1"><a href="#section-2.3.1" class="auto internal xref">2.3.1</a>.  <a href="#name-oauth-in-open-ecosystems" class="internal xref">OAuth in Open Ecosystems</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.2">
                    <p id="section-toc.1-1.2.2.3.2.2.1"><a href="#section-2.3.2" class="auto internal xref">2.3.2</a>.  <a href="#name-attack-scenario" class="internal xref">Attack Scenario</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.3">
                    <p id="section-toc.1-1.2.2.3.2.3.1"><a href="#section-2.3.3" class="auto internal xref">2.3.3</a>.  <a href="#name-mix-up-attacks-reloaded" class="internal xref">Mix-Up Attacks Reloaded</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.4">
                    <p id="section-toc.1-1.2.2.3.2.4.1"><a href="#section-2.3.4" class="auto internal xref">2.3.4</a>.  <a href="#name-client-configuration-confus" class="internal xref">Client Configuration Confusion Attack</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-document-history" class="internal xref">Document History</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="Introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Since the publication of the first OAuth 2.0 Security Best Practices
document <span>[<a href="#RFC9700" class="cite xref">RFC9700</a>]</span>, new threats to OAuth 2.0 ecosystems have been
identified. This document therefore serves as an extension of the
original <span>[<a href="#RFC9700" class="cite xref">RFC9700</a>]</span> and is to be read in conjunction with it.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Like <span>[<a href="#RFC9700" class="cite xref">RFC9700</a>]</span> before, this document provides important security
recommendations and it is <span class="bcp14">RECOMMENDED</span> that implementers upgrade their
implementations and ecosystems as soon as feasible.<a href="#section-1-2" class="pilcrow">¶</a></p>
<div id="structure">
<section id="section-1.1">
        <h3 id="name-structure">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-structure" class="section-name selfRef">Structure</a>
        </h3>
<p id="section-1.1-1">The remainder of this document is organized as follows: Section 2 is a detailed analysis of the threats and implementation issues that can be found in the wild (at the time of writing) along with a discussion of potential countermeasures.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conventions-and-terminology">
<section id="section-1.2">
        <h3 id="name-conventions-and-terminology">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-conventions-and-terminology" class="section-name selfRef">Conventions and Terminology</a>
        </h3>
<p id="section-1.2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<p id="section-1.2-2">This specification uses the terms "access token", "authorization
endpoint", "authorization grant", "authorization server", "client",
"client identifier" (client ID), "protected resource", "refresh
token", "resource owner", "resource server", and "token endpoint"
defined by OAuth 2.0 <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>.<a href="#section-1.2-2" class="pilcrow">¶</a></p>
<p id="section-1.2-3"><span class="cref" id="terminology-update">Make sure to update this list once the
technical sections below are completed.<span class="crefSource">Tim W.</span></span><a href="#section-1.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="AttacksMitigations">
<section id="section-2">
      <h2 id="name-attacks-and-mitigations">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-attacks-and-mitigations" class="section-name selfRef">Attacks and Mitigations</a>
      </h2>
<p id="section-2-1">This section gives a detailed description of new attacks on OAuth implementations, along with potential countermeasures. Attacks and mitigations already covered in <span>[<a href="#RFC9700" class="cite xref">RFC9700</a>]</span> are not listed here, except where clarifications or new recommendations are made.
Generally, the attacks in this section assume a scenario where a client can interact with multiple authorization servers.<a href="#section-2-1" class="pilcrow">¶</a></p>
<div id="AudienceInjection">
<section id="section-2.1">
        <h3 id="name-audience-injection-attacks">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-audience-injection-attacks" class="section-name selfRef">Audience Injection Attacks</a>
        </h3>
<p id="section-2.1-1">When using signature-based client authentication methods such as
<code>private_key_jwt</code> as defined in <span>[<a href="#OpenID.Core" class="cite xref">OpenID.Core</a>]</span> or signed JWTs as
defined in <span>[<a href="#RFC7521" class="cite xref">RFC7521</a>]</span> and <span>[<a href="#RFC7523" class="cite xref">RFC7523</a>]</span>, a malicious authorization
server may be able to obtain and use a client's authentication
credential, enabling them to impersonate a client towards another
honest authorization server.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<div id="attack-description">
<section id="section-2.1.1">
          <h4 id="name-attack-description">
<a href="#section-2.1.1" class="section-number selfRef">2.1.1. </a><a href="#name-attack-description" class="section-name selfRef">Attack Description</a>
          </h4>
<p id="section-2.1.1-1">The descriptions here follow <span>[<a href="#research.ust" class="cite xref">research.ust</a>]</span>, where additional details
of the attack are laid out.  Audience injection attacks require a client
to interact with at least two authorization servers, one of which is
malicious, and to authenticate to both with a signature-based
authentication method using the same key pair.  The following
description uses the <code>jwt-bearer</code> client authentication from
<span>[<a href="#RFC7523" class="cite xref">RFC7523</a>]</span>, see <a href="#AudienceInjectionAuthNMethods" class="auto internal xref">Section 2.1.1.3</a> for other affected
client authentication methods.  Furthermore, the client needs to be
willing to authenticate at an endpoint other than the token endpoint at
the attacker authorization server (see <a href="#AudienceInjectionEndpoints" class="auto internal xref">Section 2.1.1.2</a>).<a href="#section-2.1.1-1" class="pilcrow">¶</a></p>
<div id="core-attack-steps">
<section id="section-2.1.1.1">
            <h5 id="name-core-attack-steps">
<a href="#section-2.1.1.1" class="section-number selfRef">2.1.1.1. </a><a href="#name-core-attack-steps" class="section-name selfRef">Core Attack Steps</a>
            </h5>
<p id="section-2.1.1.1-1">In the following, let H-AS be an honest authorization server and let
A-AS be an attacker-controlled authorization server.<a href="#section-2.1.1.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1.1.1-2">Assume that the authorization servers publish the following URIs for
their token endpoints, for example via mechanisms such as authorization
server metadata <span>[<a href="#RFC8414" class="cite xref">RFC8414</a>]</span> or OpenID Discovery <span>[<a href="#OpenID.Discovery" class="cite xref">OpenID.Discovery</a>]</span>.
The exact publication mechanism is not relevant, as audience injection
attacks are also possible on clients with manually configured
authorization server metadata.<a href="#section-2.1.1.1-2" class="pilcrow">¶</a></p>
<p id="section-2.1.1.1-3">Excerpt from H-AS' metadata:<a href="#section-2.1.1.1-3" class="pilcrow">¶</a></p>
<div class="lang-javascript sourcecode" id="section-2.1.1.1-4">
<pre>
"issuer": "https://honest.com",
"token_endpoint": "https://honest.com/token",
...
</pre><a href="#section-2.1.1.1-4" class="pilcrow">¶</a>
</div>
<p id="section-2.1.1.1-5">Excerpt from A-AS' metadata:<a href="#section-2.1.1.1-5" class="pilcrow">¶</a></p>
<div class="lang-javascript sourcecode" id="section-2.1.1.1-6">
<pre>
"issuer": "https://attacker.com",
"token_endpoint": "https://honest.com/token",
...
</pre><a href="#section-2.1.1.1-6" class="pilcrow">¶</a>
</div>
<p id="section-2.1.1.1-7">Therefore, the attacker authorization server claims to use the honest
authorization server's token endpoint. Note that the attacker
authorization server does not control this endpoint. The attack then
commences as follows:<a href="#section-2.1.1.1-7" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.1.1.1-8">
<li id="section-2.1.1.1-8.1">
                <p id="section-2.1.1.1-8.1.1">Client registers at H-AS, and gets assigned a client ID <code>cid</code>.<a href="#section-2.1.1.1-8.1.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-2.1.1.1-8.2">
                <p id="section-2.1.1.1-8.2.1">Client registers at A-AS, and gets assigned the same client ID
<code>cid</code>. Note that the client ID is not a secret (<span><a href="https://rfc-editor.org/rfc/rfc6749#section-2.2" class="relref">Section 2.2</a> of [<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>).<a href="#section-2.1.1.1-8.2.1" class="pilcrow">¶</a></p>
</li>
            </ol>
<p id="section-2.1.1.1-9">Now, whenever the client creates a client assertion for authentication
to A-AS, the assertion consists of a JSON Web Token (JWT) that is signed
by the client and contains, among others, the following claims:<a href="#section-2.1.1.1-9" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-2.1.1.1-10">
<pre>
"iss": "cid",
"sub": "cid",
"aud": "https://honest.com/token"
</pre><a href="#section-2.1.1.1-10" class="pilcrow">¶</a>
</div>
<p id="section-2.1.1.1-11">Due to the malicious use of H-AS' token endpoint in A-AS'
authorization server metadata, the <code>aud</code> claim contains H-AS' token
endpoint.  Recall that both A-AS and H-AS registered the client with
client ID <code>cid</code>, and that the client uses the same key pair for
authentication at both authorization servers.  Hence, this client
assertion is a valid authentication credential for the client at
H-AS.<a href="#section-2.1.1.1-11" class="pilcrow">¶</a></p>
<p id="section-2.1.1.1-12">The use of the token endpoint to identify the authorization server as a
client assertion's audience even for client assertions that are not sent
to the token endpoint is encouraged, or at least allowed by many
standards, including <span>[<a href="#RFC7521" class="cite xref">RFC7521</a>]</span>, <span>[<a href="#RFC7522" class="cite xref">RFC7522</a>]</span>, <span>[<a href="#RFC7523" class="cite xref">RFC7523</a>]</span>, <span>[<a href="#RFC9126" class="cite xref">RFC9126</a>]</span>,
<span>[<a href="#OpenID.Core" class="cite xref">OpenID.Core</a>]</span>, <span>[<a href="#OpenID.CIBA" class="cite xref">OpenID.CIBA</a>]</span>, and all standards referencing the IANA
registry for OAuth Token Endpoint Authentication Methods for available
client authentication methods.<a href="#section-2.1.1.1-12" class="pilcrow">¶</a></p>
<p id="section-2.1.1.1-13">As described in <span>[<a href="#research.ust" class="cite xref">research.ust</a>]</span>, the attacker can then utilize the
obtained client authentication assertion to impersonate the client and,
for example, obtain access tokens.<a href="#section-2.1.1.1-13" class="pilcrow">¶</a></p>
</section>
</div>
<div id="AudienceInjectionEndpoints">
<section id="section-2.1.1.2">
            <h5 id="name-endpoints-requiring-client-">
<a href="#section-2.1.1.2" class="section-number selfRef">2.1.1.2. </a><a href="#name-endpoints-requiring-client-" class="section-name selfRef">Endpoints Requiring Client Authentication</a>
            </h5>
<p id="section-2.1.1.2-1">As mentioned above, the attack is only possible if the client
authenticates to an endpoint other than the token endpoint at A-AS.
This is because if the client sends a token request to A-AS, it will use
A-AS' token endpoint as published by A-AS and hence, send the token
request to H-AS, i.e., the attacker cannot obtain the client assertion.<a href="#section-2.1.1.2-1" class="pilcrow">¶</a></p>
<p id="section-2.1.1.2-2">As detailed in <span>[<a href="#research.ust" class="cite xref">research.ust</a>]</span>, the attack is confirmed to be possible
if the client authenticates with such client assertions at the following
endpoints of A-AS:<a href="#section-2.1.1.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1.1.2-3.1">
                <p id="section-2.1.1.2-3.1.1">Pushed Authorization Endpoint (see <span>[<a href="#RFC9126" class="cite xref">RFC9126</a>]</span>)<a href="#section-2.1.1.2-3.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.1.1.2-3.2">
                <p id="section-2.1.1.2-3.2.1">Token Revocation Endpoint (see <span>[<a href="#RFC7009" class="cite xref">RFC7009</a>]</span>)<a href="#section-2.1.1.2-3.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.1.1.2-3.3">
                <p id="section-2.1.1.2-3.3.1">CIBA Backchannel Authentication Endpoint (see <span>[<a href="#OpenID.CIBA" class="cite xref">OpenID.CIBA</a>]</span>)<a href="#section-2.1.1.2-3.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.1.1.2-3.4">
                <p id="section-2.1.1.2-3.4.1">Device Authorization Endpoint (see <span>[<a href="#RFC8628" class="cite xref">RFC8628</a>]</span>)<a href="#section-2.1.1.2-3.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-2.1.1.2-4">Note that this list of examples is not exhaustive. Hence, any client
that might authenticate at any endpoint other than the token endpoint
<span class="bcp14">SHOULD</span> employ countermeasures as described in
<a href="#AudienceInjectionCountermeasures" class="auto internal xref">Section 2.1.2</a>.<a href="#section-2.1.1.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="AudienceInjectionAuthNMethods">
<section id="section-2.1.1.3">
            <h5 id="name-affected-client-authenticat">
<a href="#section-2.1.1.3" class="section-number selfRef">2.1.1.3. </a><a href="#name-affected-client-authenticat" class="section-name selfRef">Affected Client Authentication Methods</a>
            </h5>
<p id="section-2.1.1.3-1">The same attacks are possible for the <code>private_key_jwt</code> client
authentication method defined in <span>[<a href="#OpenID.Core" class="cite xref">OpenID.Core</a>]</span>, as well as
instantiations of client authentication assertions defined in
<span>[<a href="#RFC7521" class="cite xref">RFC7521</a>]</span>, including the SAML assertions defined in <span>[<a href="#RFC7522" class="cite xref">RFC7522</a>]</span>.<a href="#section-2.1.1.3-1" class="pilcrow">¶</a></p>
<p id="section-2.1.1.3-2">Furthermore, a similar attack is possible for <code>jwt-bearer</code> authorization
grants as defined in <span><a href="https://rfc-editor.org/rfc/rfc7523#section-2.1" class="relref">Section 2.1</a> of [<a href="#RFC7523" class="cite xref">RFC7523</a>]</span>, albeit under
additional assumptions (see <span>[<a href="#research.ust" class="cite xref">research.ust</a>]</span> for details).<a href="#section-2.1.1.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="AudienceInjectionCountermeasures">
<section id="section-2.1.2">
          <h4 id="name-countermeasures">
<a href="#section-2.1.2" class="section-number selfRef">2.1.2. </a><a href="#name-countermeasures" class="section-name selfRef">Countermeasures</a>
          </h4>
<p id="section-2.1.2-1">At its core, audience injection attacks exploit the fact that, from the
client's point of view, an authorization server's token endpoint is a
mostly opaque value and does not uniquely identify an authorization
server.  Therefore, an attacker authorization server may claim any URI
as its token endpoint, including, for example, an honest authorization
server's issuer identifier. Hence, as long as a client uses the token
endpoint as an audience value when authenticating to the attacker
authorization server, audience injection attacks are possible.
Therefore, audience injection attacks need to be prevented by the
client.<a href="#section-2.1.2-1" class="pilcrow">¶</a></p>
<p id="section-2.1.2-2">Note that the following countermeasures mandate the use of single
audience value (as opposed to multiple audiences in array). This is because <span><a href="https://rfc-editor.org/rfc/rfc7519#section-4.1.3" class="relref">Section 4.1.3</a> of [<a href="#RFC7519" class="cite xref">RFC7519</a>]</span> allows the receiver of an audience-restricted JWT to
accept the JWT even if the receiver identifies with only one of the
values in such an array.<a href="#section-2.1.2-2" class="pilcrow">¶</a></p>
<p id="section-2.1.2-3">Clients that interact with more than one authorization server and
authenticate with signature-based client authentication methods <span class="bcp14">MUST</span>
employ one of the following countermeasures, unless audience injection
attacks are mitigated by other means, such as using fresh key material
for each authorization server.<a href="#section-2.1.2-3" class="pilcrow">¶</a></p>
<p id="section-2.1.2-4">Note that the countermeasures described in
<a href="#AudienceInjectionCountermeasuresASissuer" class="auto internal xref">Section 2.1.2.1</a> and
<a href="#AudienceInjectionCountermeasuresTargetEP" class="auto internal xref">Section 2.1.2.2</a> do not imply any normative
changes to the authorization server: <span><a href="https://rfc-editor.org/rfc/rfc7519#section-4.1.3" class="relref">Section 4.1.3</a> of [<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>
requires the authorization server to only accept a JWT if the
authorization server can identify itself with (at least one of the
elements in) the JWT's audience value. Authentication JWTs produced by a
client implementing one of these countermeasures meet this condition.
Of course, an authorization server <span class="bcp14">MAY</span> still decide to only accept its
issuer identifier (<a href="#AudienceInjectionCountermeasuresASissuer" class="auto internal xref">Section 2.1.2.1</a>) or the
endpoint that received the JWT
(<a href="#AudienceInjectionCountermeasuresTargetEP" class="auto internal xref">Section 2.1.2.2</a>) as an audience value, for
example, to force its clients to adopt the respective countermeasure.<a href="#section-2.1.2-4" class="pilcrow">¶</a></p>
<div id="AudienceInjectionCountermeasuresASissuer">
<section id="section-2.1.2.1">
            <h5 id="name-authorization-server-issuer">
<a href="#section-2.1.2.1" class="section-number selfRef">2.1.2.1. </a><a href="#name-authorization-server-issuer" class="section-name selfRef">Authorization Server Issuer Identifier</a>
            </h5>
<p id="section-2.1.2.1-1">Clients <span class="bcp14">MUST</span> use the authorization server's issuer identifier as defined
in <span>[<a href="#RFC8414" class="cite xref">RFC8414</a>]</span>/<span>[<a href="#OpenID.Discovery" class="cite xref">OpenID.Discovery</a>]</span> as the sole audience value in
client assertions. Clients <span class="bcp14">MUST</span> retrieve and validate this value as
described in <span><a href="https://rfc-editor.org/rfc/rfc8414#section-3.3" class="relref">Section 3.3</a> of [<a href="#RFC8414" class="cite xref">RFC8414</a>]</span>/Section 4.3 of
<span>[<a href="#OpenID.Discovery" class="cite xref">OpenID.Discovery</a>]</span>.<a href="#section-2.1.2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1.2.1-2">For <code>jwt-bearer</code> client assertions as defined by <span>[<a href="#RFC7523" class="cite xref">RFC7523</a>]</span>, this
mechanism is also described in <span>[<a href="#OAUTH-7523bis" class="cite xref">OAUTH-7523bis</a>]</span>.<a href="#section-2.1.2.1-2" class="pilcrow">¶</a></p>
<p id="section-2.1.2.1-3">Note that "issuer identifier" here does not refer to the term "issuer"
as defined in <span><a href="https://rfc-editor.org/rfc/rfc9700#section-4.4" class="relref">Section 4.4</a> of [<a href="#RFC9700" class="cite xref">RFC9700</a>]</span>, but to the issuer identifier
defined in <span>[<a href="#RFC8414" class="cite xref">RFC8414</a>]</span> and <span>[<a href="#OpenID.Discovery" class="cite xref">OpenID.Discovery</a>]</span>. In particular, the
issuer identifier is not just "an abstract identifier for the
combination the authorization endpoint and token endpoint".<a href="#section-2.1.2.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="AudienceInjectionCountermeasuresTargetEP">
<section id="section-2.1.2.2">
            <h5 id="name-exact-target-endpoint-uri">
<a href="#section-2.1.2.2" class="section-number selfRef">2.1.2.2. </a><a href="#name-exact-target-endpoint-uri" class="section-name selfRef">Exact Target Endpoint URI</a>
            </h5>
<p id="section-2.1.2.2-1">Clients <span class="bcp14">MUST</span> use the exact endpoint URI to which a client assertion is
sent as that client assertion's sole audience value.<a href="#section-2.1.2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.1.2.2-2">This countermeasure can be used for authorization servers that do not
use authorization server metadata <span>[<a href="#RFC8414" class="cite xref">RFC8414</a>]</span> or OpenID Discovery
<span>[<a href="#OpenID.Discovery" class="cite xref">OpenID.Discovery</a>]</span>.<a href="#section-2.1.2.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="MixUpUpdate">
<section id="section-2.2">
        <h3 id="name-updates-to-mix-up-attacks">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-updates-to-mix-up-attacks" class="section-name selfRef">Updates to Mix-Up Attacks</a>
        </h3>
<p id="section-2.2-1">Mix-up attacks can occur in scenarios where an OAuth client interacts with two or more authorization servers and at least one authorization server is under the control of the attacker.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2-2">This section extends the mix-up attack analysis in <span><a href="https://rfc-editor.org/rfc/rfc9700#section-4.4" class="relref">Section 4.4</a> of [<a href="#RFC9700" class="cite xref">RFC9700</a>]</span>. It introduces additional attack variants that can occur when clients use distinct redirection URIs for each authorization server and clarifies the applicability of countermeasures to certain attack variants.<a href="#section-2.2-2" class="pilcrow">¶</a></p>
<div id="PerASUpdate">
<section id="section-2.2.1">
          <h4 id="name-updates-to-per-as-redirect-">
<a href="#section-2.2.1" class="section-number selfRef">2.2.1. </a><a href="#name-updates-to-per-as-redirect-" class="section-name selfRef">Updates to "Per-AS Redirect URIs" Mix-Up Variant</a>
          </h4>
<p id="section-2.2.1-1">The basic mix-up attack described in the initial paragraphs of <span><a href="https://rfc-editor.org/rfc/rfc9700#section-4.4.1" class="relref">Section 4.4.1</a> of [<a href="#RFC9700" class="cite xref">RFC9700</a>]</span> specifies, as one of its preconditions, that "the client stores the authorization server chosen by the user in a session bound to the user's browser and uses the same redirection URI for each authorization server".<a href="#section-2.2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.2.1-2">If the client instead uses a distinct redirection URI for each authorization server (i.e., Per-AS Redirect URIs), three subvariants of mix-up attacks are still possible. This section updates the description of the "Per-AS Redirect URIs" mix-up variant in <span><a href="https://rfc-editor.org/rfc/rfc9700#section-4.4.1" class="relref">Section 4.4.1</a> of [<a href="#RFC9700" class="cite xref">RFC9700</a>]</span>, with subvariants 1 and 2 newly introduced in this document:<a href="#section-2.2.1-2" class="pilcrow">¶</a></p>
<p id="section-2.2.1-3">Per-AS Redirect URIs: There are three subvariants of mix-up attacks when the client uses distinct redirection URIs for each authorization server.<a href="#section-2.2.1-3" class="pilcrow">¶</a></p>
<p id="section-2.2.1-4">Subvariant 1: Advanced Mix-up Attack. If the client uses different redirection URIs for different authorization servers but treats them as the same URI, a slight variant of the basic mix-up attack remains possible (see Footnote 7 of <span>[<a href="#arXiv.1601.01229" class="cite xref">arXiv.1601.01229</a>]</span>). In this attack, the attacker not only replaces the client ID as in the basic mix-up attack, but also replaces the redirection URI when redirecting the browser to the authorization endpoint of the honest authorization server.<a href="#section-2.2.1-4" class="pilcrow">¶</a></p>
<p id="section-2.2.1-5">This advanced mix-up attack is described in detail below, with the Preconditions as well as Step 2 and Step 3 updated compared to the basic mix-up attack.<a href="#section-2.2.1-5" class="pilcrow">¶</a></p>
<p id="section-2.2.1-6">Preconditions: For this variant of the attack to work, it is assumed that<a href="#section-2.2.1-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.1-7.1">
              <p id="section-2.2.1-7.1.1">the implicit or authorization code grant is used with multiple authorization servers of which one is considered "honest" (H-AS) and one is operated by the attacker (A-AS), and<a href="#section-2.2.1-7.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.1-7.2">
              <p id="section-2.2.1-7.2.1">the client stores the authorization server chosen by the user in a session bound to the user's browser and uses distinct redirection URIs for different authorization servers, but treats them as the same URI (i.e., it does not use the redirection URI to differentiate authorization servers at the redirection endpoint).<a href="#section-2.2.1-7.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-2.2.1-8">In the following, it is further assumed that the client is registered with H-AS (URI: <code>https://honest.as.example</code>, client ID: <code>7ZGZldHQ</code>) and with A-AS (URI: <code>https://attacker.example</code>, client ID: <code>666RVZJTA</code>). Assume that the client issues the redirection URI <code>https://client.com/9XpLmK2qR/cb</code> for H-AS and <code>https://client.com/4FvBn8TzY/cb</code> for A-AS. URLs shown in the following example are shortened for presentation to include only parameters relevant to the attack.<a href="#section-2.2.1-8" class="pilcrow">¶</a></p>
<p id="section-2.2.1-9">Attack on the authorization code grant:<a href="#section-2.2.1-9" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.2.1-10">
<li id="section-2.2.1-10.1">
              <p id="section-2.2.1-10.1.1">The user selects to start the grant using A-AS (e.g., by clicking on a button on the client's website).<a href="#section-2.2.1-10.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.2.1-10.2">
              <p id="section-2.2.1-10.2.1">The client stores in the user's session that the user selected "A-AS" and redirects the user to A-AS's authorization endpoint with a Location header containing the URL <code>https://attacker.example/authorize?response_type=code&amp;client_id=666RVZJTA</code>
                <code>&amp;redirect_uri=https%3A%2F%2Fclient.com%2F4FvBn8TzY%2Fcb</code>.<a href="#section-2.2.1-10.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.2.1-10.3">
              <p id="section-2.2.1-10.3.1">When the user's browser navigates to the attacker's authorization endpoint, the attacker immediately redirects the browser to the authorization endpoint of H-AS. In the authorization request, the attacker replaces the client ID of the client at A-AS with the client's ID at H-AS, and replaces the redirection URI of A-AS with the redirection URI of H-AS. Therefore, the browser receives a redirection (<code>303 See Other</code>) with a Location header pointing to <code>https://honest.as.example/authorize?response_type=code&amp;client_id=7ZGZldHQ</code>
                <code>&amp;redirect_uri=https%3A%2F%2Fclient.com%2F9XpLmK2qR%2Fcb</code>.<a href="#section-2.2.1-10.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.2.1-10.4">
              <p id="section-2.2.1-10.4.1">The user authorizes the client to access their resources at H-AS. H-AS issues a code and sends it (via the browser) back to the client.<a href="#section-2.2.1-10.4.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.2.1-10.5">
              <p id="section-2.2.1-10.5.1">Since the client still assumes that the code was issued by A-AS, it will try to redeem the code at A-AS's token endpoint.<a href="#section-2.2.1-10.5.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.2.1-10.6">
              <p id="section-2.2.1-10.6.1">The attacker therefore obtains code and can either exchange the code for an access token (for public clients) or perform an authorization code injection attack as described in <span><a href="https://rfc-editor.org/rfc/rfc9700#section-4.5" class="relref">Section 4.5</a> of [<a href="#RFC9700" class="cite xref">RFC9700</a>]</span>.<a href="#section-2.2.1-10.6.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-2.2.1-11">Subvariant 2: Naïve RP Session Integrity Attack. If clients use different redirection URIs for different authorization servers, and clients do not store the selected authorization server in the user's session, attackers can mount an attack called "Naïve RP Session Integrity Attack". Note that unlike other mix-up variants, the goal of this attack is not to obtain an authorization code or access token, but to force the client to use an attacker's authorization code or access token for H-AS. See Section 3.4 of <span>[<a href="#arXiv.1601.01229" class="cite xref">arXiv.1601.01229</a>]</span> for details.<a href="#section-2.2.1-11" class="pilcrow">¶</a></p>
<p id="section-2.2.1-12">Subvariant 3: Cross Social-Network Request Forgery. If clients use different redirection URIs for different authorization servers, clients do not store the selected authorization server in the user's session, and authorization servers do not check the redirection URIs properly (see <span><a href="https://rfc-editor.org/rfc/rfc9700#section-4.1" class="relref">Section 4.1</a> of [<a href="#RFC9700" class="cite xref">RFC9700</a>]</span>), attackers can mount an attack called "Cross Social-Network Request Forgery". These attacks have been observed in practice. Refer to <span>[<a href="#research.jcs_14" class="cite xref">research.jcs_14</a>]</span> for details.<a href="#section-2.2.1-12" class="pilcrow">¶</a></p>
</section>
</div>
<div id="CountermeasureUpdate">
<section id="section-2.2.2">
          <h4 id="name-clarifications-on-counterme">
<a href="#section-2.2.2" class="section-number selfRef">2.2.2. </a><a href="#name-clarifications-on-counterme" class="section-name selfRef">Clarifications on Countermeasures for Mix-Up Variants</a>
          </h4>
<p id="section-2.2.2-1"><span><a href="https://rfc-editor.org/rfc/rfc9700#section-4.4.2" class="relref">Section 4.4.2</a> of [<a href="#RFC9700" class="cite xref">RFC9700</a>]</span> specifies two countermeasures, Mix-Up Defense via Issuer Identification and via Distinct Redirect URIs (referred to hereafter as "existing mix-up defenses"). Both defenses require the client to store and compare the issuer of the authorization server. Specifically, the issuer is defined in the second paragraph of <span><a href="https://rfc-editor.org/rfc/rfc9700#section-4.4.2" class="relref">Section 4.4.2</a> of [<a href="#RFC9700" class="cite xref">RFC9700</a>]</span> as follows:<a href="#section-2.2.2-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.2.2-2.1">
              <p id="section-2.2.2-2.1.1">The issuer serves ... as an abstract identifier for the combination of the authorization endpoint and token endpoint that are to be used in the flow. If an issuer identifier is not available ..., a different unique identifier for this tuple or the tuple itself can be used instead.<a href="#section-2.2.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-2.2.2-3">Existing mix-up defenses are sufficient to protect against most attack variants, with a few specific cases requiring clarification:<a href="#section-2.2.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.2-4.1">
              <p id="section-2.2.2-4.1.1">For the mix-up attack variant in "Implicit Grant", since the flow does not involve a token endpoint, a unique identifier for the authorization endpoint URL <span class="bcp14">MAY</span> be used as the equivalent of issuer if an issuer identifier is not available. Then, clients <span class="bcp14">MUST</span> apply existing mix-up defenses.<a href="#section-2.2.2-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.2-4.2">
              <p id="section-2.2.2-4.2.1">For all three subvariants of the "Per-AS Redirect URIs" attack variant (<a href="#PerASUpdate" class="auto internal xref">Section 2.2.1</a>), clients <span class="bcp14">MUST</span> follow existing mix-up defenses to defend against mix-up attacks. Clients <span class="bcp14">MAY</span> choose to reuse the per-AS redirection URI already configured in their deployments to satisfy the "distinct redirection URI for each issuer" requirement when implementing the "Mix-Up Defense via Distinct Redirect URIs" defense (<span><a href="https://rfc-editor.org/rfc/rfc9700#section-4.4.2.2" class="relref">Section 4.4.2.2</a> of [<a href="#RFC9700" class="cite xref">RFC9700</a>]</span>). For subvariant 3 ("Cross Social-Network Request Forgery"), the existing mix-up defenses alone are not sufficient. In addition, authorization servers <span class="bcp14">MUST</span> enforce exact redirection URI matching, as specified in <span><a href="https://rfc-editor.org/rfc/rfc9700#section-4.1.3" class="relref">Section 4.1.3</a> of [<a href="#RFC9700" class="cite xref">RFC9700</a>]</span>.<a href="#section-2.2.2-4.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-2.2.2-5">Note that when the issuer is not unique to a client (i.e., when a client can interact with multiple configurations of the same authorization server), the security considerations go beyond the scope of mix-up attacks and are discussed further in <a href="#OpenEcosystem" class="auto internal xref">Section 2.3</a>.<a href="#section-2.2.2-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="OpenEcosystem">
<section id="section-2.3">
        <h3 id="name-attacks-in-open-ecosystems">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-attacks-in-open-ecosystems" class="section-name selfRef">Attacks in Open Ecosystems</a>
        </h3>
<p id="section-2.3-1">This section describes the OAuth use case and associated attacks in open ecosystems, along with practical countermeasures tailored to such environments.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<div id="ApplicationScenario">
<section id="section-2.3.1">
          <h4 id="name-oauth-in-open-ecosystems">
<a href="#section-2.3.1" class="section-number selfRef">2.3.1. </a><a href="#name-oauth-in-open-ecosystems" class="section-name selfRef">OAuth in Open Ecosystems</a>
          </h4>
<p id="section-2.3.1-1">In traditional OAuth deployments, a client registers with an authorization server to access protected resources hosted by a resource server.
The means through which the client registers with an authorization server typically involve the client developer manually registering the client at the authorization server's website, or by using Dynamic Client Registration <span>[<a href="#RFC7591" class="cite xref">RFC7591</a>]</span>.
The client may access different resources from distinct resource servers, thereby requiring registration with multiple authorization servers.
The choice of what resources to access (and thus which authorization and resource servers to integrate) is at the discretion of the client (or client developer).<a href="#section-2.3.1-1" class="pilcrow">¶</a></p>
<p id="section-2.3.1-2">This section discusses OAuth in "open ecosystems", where the protected resources accessible to a client are configured beyond the discretion of the client or client developers.
This can be the case, for example, if the client offers an open marketplace or registry where external developers can publish information about resource servers and associated authorization servers at development time (e.g., in integration platforms, where external services register themselves as authorization and resource servers with a platform that acts as a client, see <span>[<a href="#research.cuhk" class="cite xref">research.cuhk</a>]</span>), or if an end-user can specify any compliant configurations to interact with at runtime (e.g., in the Model Context Protocol <span>[<a href="#MCP-Spec" class="cite xref">MCP-Spec</a>]</span>).<a href="#section-2.3.1-2" class="pilcrow">¶</a></p>
<p id="section-2.3.1-3">This document defines a "client configuration" as a set of configuration elements that enable a client to access an OAuth 2.0 protected resource, including details about the authorization server, client registration, and the resource server.
In open ecosystems, these configuration elements are typically managed as follows:<a href="#section-2.3.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.3.1-4.1">
              <p id="section-2.3.1-4.1.1">Authorization Server configuration: Clients may employ a manual approach, where external developers or end-users enter the necessary fields (i.e., endpoint URLs of the authorization server) at the client's website, or support fetching information about the authorization server via Authorization Server Metadata <span>[<a href="#RFC8414" class="cite xref">RFC8414</a>]</span>.<a href="#section-2.3.1-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.3.1-4.2">
              <p id="section-2.3.1-4.2.1">Client Registration configuration at the authorization server: Clients may employ a manual approach, where external developers or end-users enter the necessary fields (i.e., client identifier and client credentials) at the client's website, or support fetching information about the client registration via Dynamic Client Registration <span>[<a href="#RFC7591" class="cite xref">RFC7591</a>]</span>.<a href="#section-2.3.1-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.3.1-4.3">
              <p id="section-2.3.1-4.3.1">Protected Resource configuration: Clients may employ a manual approach, where external developers or end-users enter the necessary fields (i.e., endpoint URLs of the resource server) at the client's website, or support fetching information about the protected resource via Protected Resource Metadata <span>[<a href="#RFC9728" class="cite xref">RFC9728</a>]</span>. External developers or end-users may further specify when and how the protected resources shall be fetched and processed by the clients.<a href="#section-2.3.1-4.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-2.3.1-5">The integration pattern in open ecosystems expands the use of OAuth in dynamic scenarios, creating new challenges with respect to functionality and security beyond the scope of <span>[<a href="#RFC9700" class="cite xref">RFC9700</a>]</span>.<a href="#section-2.3.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="AttackScenario">
<section id="section-2.3.2">
          <h4 id="name-attack-scenario">
<a href="#section-2.3.2" class="section-number selfRef">2.3.2. </a><a href="#name-attack-scenario" class="section-name selfRef">Attack Scenario</a>
          </h4>
<p id="section-2.3.2-1">With the new integration model, OAuth in open ecosystems introduces two notable implications:<a href="#section-2.3.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.3.2-2.1">
              <p id="section-2.3.2-2.1.1">Increased risk of malicious integration: Since the responsibility of integrating client configurations is shifted to external developers or end-users, there is an increased risk that malicious client configurations may be introduced, including attacker-controlled authorization servers or resource servers.<a href="#section-2.3.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.3.2-2.2">
              <p id="section-2.3.2-2.2.1">New requirements for handling shared issuers: Clients shall support client configurations with potentially shared issuers (explained below) to fulfill functional needs, which in turn introduces new security gaps.<a href="#section-2.3.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-2.3.2-3">In traditional OAuth deployments, it is implicitly assumed that there is exactly one client configuration for each client-authorization server pair. Under this assumption, the issuer (as defined in <span><a href="https://rfc-editor.org/rfc/rfc9700#section-4.4.2" class="relref">Section 4.4.2</a> of [<a href="#RFC9700" class="cite xref">RFC9700</a>]</span>) serves as a unique identifier for the client. This has led to the common practice of clients tracking "the authorization server chosen by the user" during OAuth flows, as well as the adoption of existing mix-up defenses (<span><a href="https://rfc-editor.org/rfc/rfc9700#section-4.4.2" class="relref">Section 4.4.2</a> of [<a href="#RFC9700" class="cite xref">RFC9700</a>]</span>), all of which are based on the issuer concept that uniquely identifies each authorization server from the client's point of view.<a href="#section-2.3.2-3" class="pilcrow">¶</a></p>
<p id="section-2.3.2-4">In open ecosystems, however, the new integration pattern does not, and fundamentally cannot, restrict the use of the same authorization server across multiple client configurations. For instance, clients may legitimately integrate various functionalities that access different resources or process the same resources differently, while relying on the same authorization server (i.e., having shared issuers, which implies that the issuer no longer uniquely identifies a client configuration).<a href="#section-2.3.2-4" class="pilcrow">¶</a></p>
<p id="section-2.3.2-5">As a result, the client may integrate with an authorization server under the attacker's control (<a href="#MixUpReloaded" class="auto internal xref">Section 2.3.3</a>), or an attacker-controlled resource server paired with an honest authorization server -- even if the authorization server is already integrated at the client under a different client configuration (<a href="#ConfigConfusion" class="auto internal xref">Section 2.3.4</a>).<a href="#section-2.3.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="MixUpReloaded">
<section id="section-2.3.3">
          <h4 id="name-mix-up-attacks-reloaded">
<a href="#section-2.3.3" class="section-number selfRef">2.3.3. </a><a href="#name-mix-up-attacks-reloaded" class="section-name selfRef">Mix-Up Attacks Reloaded</a>
          </h4>
<p id="section-2.3.3-1">This section provides a tailored attack description and alternative countermeasure for mix-up attacks in open ecosystems. The descriptions here follow <span>[<a href="#research.cuhk" class="cite xref">research.cuhk</a>]</span>, where additional details are laid out.<a href="#section-2.3.3-1" class="pilcrow">¶</a></p>
<div id="ReloadedDescription">
<section id="section-2.3.3.1">
            <h5 id="name-attack-description-2">
<a href="#section-2.3.3.1" class="section-number selfRef">2.3.3.1. </a><a href="#name-attack-description-2" class="section-name selfRef">Attack Description</a>
            </h5>
<p id="section-2.3.3.1-1"><span><a href="https://rfc-editor.org/rfc/rfc9700#section-4.4" class="relref">Section 4.4</a> of [<a href="#RFC9700" class="cite xref">RFC9700</a>]</span> exemplifies scenarios in which an attacker-controlled authorization server may be introduced:<a href="#section-2.3.3.1-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.3.3.1-2.1">
                <p id="section-2.3.3.1-2.1.1">This can be the case, for example, if the attacker uses dynamic registration to register the client at their own authorization server, or if an authorization server becomes compromised.<a href="#section-2.3.3.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-2.3.3.1-3">OAuth deployments in open ecosystems extend the above scenarios: an external developer or end-user can introduce an attacker-controlled authorization server by integrating a new client configuration at the client.<a href="#section-2.3.3.1-3" class="pilcrow">¶</a></p>
<p id="section-2.3.3.1-4">Furthermore, multiple client configurations may use the same authorization server (i.e., share the same issuer).
To manage such scenarios, the client should treat each client configuration independently, typically by keeping track of the client configuration chosen by the user during the OAuth flow. For example, the client may store a unique identifier for each client configuration (rather than for each authorization server) in the user's session, or assign a distinct redirection URI to each client configuration.
This enables the client to distinguish between client configurations, retrieve the correct client registration information for access token requests, and access the intended protected resources.<a href="#section-2.3.3.1-4" class="pilcrow">¶</a></p>
<p id="section-2.3.3.1-5">Attackers can exploit this setup to mount mix-up attacks, using a malicious authorization server from an attacker-controlled client configuration to target the honest authorization server from an honest client configuration. For details on this attack vector, see "Cross-app OAuth Account Takeover" (COAT) and "Cross-app OAuth Request Forgery" (CORF) in Section 4.2 of <span>[<a href="#research.cuhk" class="cite xref">research.cuhk</a>]</span>.<a href="#section-2.3.3.1-5" class="pilcrow">¶</a></p>
<p id="section-2.3.3.1-6">As an example, the attack analogous to the Advanced Mix-up Attack described in <a href="#PerASUpdate" class="auto internal xref">Section 2.2.1</a> is outlined below.<a href="#section-2.3.3.1-6" class="pilcrow">¶</a></p>
<p id="section-2.3.3.1-7">Preconditions: For this variant of the attack to work, it is assumed that<a href="#section-2.3.3.1-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.3.3.1-8.1">
                <p id="section-2.3.3.1-8.1.1">the implicit or authorization code grant is used with multiple client configurations of which one is considered "honest" (H-Config) and one is operated by the attacker (A-Config), and<a href="#section-2.3.3.1-8.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.3.3.1-8.2">
                <p id="section-2.3.3.1-8.2.1">the client stores the client configuration chosen by the user in a session bound to the user's browser and uses distinct redirection URIs for different client configurations, but treats them as the same URI (i.e., it does not use the redirection URI to differentiate client configurations at the redirection endpoint).<a href="#section-2.3.3.1-8.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-2.3.3.1-9">In the following, it is further assumed that the client is registered with an honest authorization server H-AS (URI: <code>https://honest.as.example</code>, client ID: <code>7ZGZldHQ</code>) under H-Config and with an attacker-controlled authorization server A-AS (URI: <code>https://attacker.example</code>, client ID: <code>666RVZJTA</code>) under A-Config. Assume that the client issues the redirection URI <code>https://client.com/9XpLmK2qR/cb</code> for H-Config and <code>https://client.com/4FvBn8TzY/cb</code> for A-Config. URLs shown in the following example are shortened for presentation to include only parameters relevant to the attack.<a href="#section-2.3.3.1-9" class="pilcrow">¶</a></p>
<p id="section-2.3.3.1-10">Attack on the authorization code grant:<a href="#section-2.3.3.1-10" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.3.3.1-11">
<li id="section-2.3.3.1-11.1">
                <p id="section-2.3.3.1-11.1.1">The user selects to start the grant using A-Config (e.g., by clicking on a button on the client's website).<a href="#section-2.3.3.1-11.1.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-2.3.3.1-11.2">
                <p id="section-2.3.3.1-11.2.1">The client stores in the user's session that the user selected "A-Config" and redirects the user to A-AS's authorization endpoint with a Location header containing the URL <code>https://attacker.example/authorize?response_type=code&amp;client_id=666RVZJTA</code>
                  <code>&amp;redirect_uri=https%3A%2F%2Fclient.com%2F4FvBn8TzY%2Fcb</code>.<a href="#section-2.3.3.1-11.2.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-2.3.3.1-11.3">
                <p id="section-2.3.3.1-11.3.1">When the user's browser navigates to the attacker's authorization endpoint, the attacker immediately redirects the browser to the authorization endpoint of H-AS. In the authorization request, the attacker replaces the client ID of the client at A-Config with the client's ID at H-Config, and replaces the redirection URI of A-Config with the redirection URI of H-Config. Therefore, the browser receives a redirection (<code>303 See Other</code>) with a Location header pointing to <code>https://honest.as.example/authorize?response_type=code&amp;client_id=7ZGZldHQ</code>
                  <code>&amp;redirect_uri=https%3A%2F%2Fclient.com%2F9XpLmK2qR%2Fcb</code>.<a href="#section-2.3.3.1-11.3.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-2.3.3.1-11.4">
                <p id="section-2.3.3.1-11.4.1">The user authorizes the client to access their resources at H-AS. H-AS issues a code and sends it (via the browser) back to the client.<a href="#section-2.3.3.1-11.4.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-2.3.3.1-11.5">
                <p id="section-2.3.3.1-11.5.1">Since the client assumes that the code was issued in the interaction with A-Config, it will try to redeem the code at A-AS's token endpoint.<a href="#section-2.3.3.1-11.5.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-2.3.3.1-11.6">
                <p id="section-2.3.3.1-11.6.1">The attacker therefore obtains code and can either exchange the code for an access token (for public clients) or perform an authorization code injection attack as described in <span><a href="https://rfc-editor.org/rfc/rfc9700#section-4.5" class="relref">Section 4.5</a> of [<a href="#RFC9700" class="cite xref">RFC9700</a>]</span>.<a href="#section-2.3.3.1-11.6.1" class="pilcrow">¶</a></p>
</li>
            </ol>
</section>
</div>
<div id="ReloadedCountermeasure">
<section id="section-2.3.3.2">
            <h5 id="name-countermeasures-2">
<a href="#section-2.3.3.2" class="section-number selfRef">2.3.3.2. </a><a href="#name-countermeasures-2" class="section-name selfRef">Countermeasures</a>
            </h5>
<p id="section-2.3.3.2-1">At its core, a client in open ecosystems may integrate multiple configurations of the same authorization server, and therefore the issuer may not be unique to the client. While the existing mix-up defenses in <span><a href="https://rfc-editor.org/rfc/rfc9700#section-4.4.2" class="relref">Section 4.4.2</a> of [<a href="#RFC9700" class="cite xref">RFC9700</a>]</span> are sufficient, a variant of the "Mix-Up Defense via Distinct Redirect URIs" defense described in <span><a href="https://rfc-editor.org/rfc/rfc9700#section-4.4.2.2" class="relref">Section 4.4.2.2</a> of [<a href="#RFC9700" class="cite xref">RFC9700</a>]</span> <span class="bcp14">MAY</span> be deployed instead for practical reasons:<a href="#section-2.3.3.2-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.3.3.2-2.1">
                <p id="section-2.3.3.2-2.1.1">To apply this defense, clients <span class="bcp14">MUST</span> use a distinct redirection URI for each client configuration they interact with. Clients <span class="bcp14">MUST</span> check that the authorization response was received from the correct client configuration by comparing the distinct redirection URI for the client configuration to the URI where the authorization response was received on. If there is a mismatch, the client <span class="bcp14">MUST</span> abort the flow.<a href="#section-2.3.3.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-2.3.3.2-3">To maximize compatibility, this countermeasure imposes no new requirements on authorization servers compliant with the original OAuth 2.0 specification <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>. This is essential for securing open ecosystems where clients may be integrated with numerous client configurations, and many authorization servers may not support the "Mix-Up Defense via Issuer Identification" defense described in <span><a href="https://rfc-editor.org/rfc/rfc9700#section-4.4.2.1" class="relref">Section 4.4.2.1</a> of [<a href="#RFC9700" class="cite xref">RFC9700</a>]</span> (e.g., returning the issuer identifier via an <code>iss</code> parameter in the authorization response <span>[<a href="#RFC9207" class="cite xref">RFC9207</a>]</span>).<a href="#section-2.3.3.2-3" class="pilcrow">¶</a></p>
<p id="section-2.3.3.2-4">To ease the development burden, compared to the "Mix-Up Defense via Distinct Redirect URIs" defense outlined in <span><a href="https://rfc-editor.org/rfc/rfc9700#section-4.4.2.2" class="relref">Section 4.4.2.2</a> of [<a href="#RFC9700" class="cite xref">RFC9700</a>]</span>, this countermeasure does not require clients to manage issuers exclusively for mix-up defense. Instead, it relies on existing isolation boundaries that already serve the functional need of differentiating client configurations.<a href="#section-2.3.3.2-4" class="pilcrow">¶</a></p>
<p id="section-2.3.3.2-5">Note that this countermeasure is not intended to redefine the concept of an issuer (or issuer identifier) from an authorization server-specific identifier to one tied to client configurations. Nor does it invalidate the existing countermeasures described in <span><a href="https://rfc-editor.org/rfc/rfc9700#section-4.4.2" class="relref">Section 4.4.2</a> of [<a href="#RFC9700" class="cite xref">RFC9700</a>]</span> and clarified in <a href="#CountermeasureUpdate" class="auto internal xref">Section 2.2.2</a>, which remain sufficient to mitigate mix-up attacks in open ecosystems. Rather, this countermeasure <span class="bcp14">MAY</span> serve as an alternative defense.<a href="#section-2.3.3.2-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ConfigConfusion">
<section id="section-2.3.4">
          <h4 id="name-client-configuration-confus">
<a href="#section-2.3.4" class="section-number selfRef">2.3.4. </a><a href="#name-client-configuration-confus" class="section-name selfRef">Client Configuration Confusion Attack</a>
          </h4>
<p id="section-2.3.4-1">When client authentication is not required such as in the implicit grant or for a public client, or when signature-based client authentication methods such as <code>private_key_jwt</code> (as defined in <span>[<a href="#OpenID.Core" class="cite xref">OpenID.Core</a>]</span>) or signed JWTs (as defined in <span>[<a href="#RFC7521" class="cite xref">RFC7521</a>]</span> and <span>[<a href="#RFC7523" class="cite xref">RFC7523</a>]</span>) are used, a malicious resource server may be able to obtain an access token issued by an honest authorization server.
This is achieved by registering an honest authorization server at the client under a malicious client configuration, pairing it with an attacker-controlled resource server, thus tricking the client into sending its access tokens to the attacker instead of using them at the honest resource server.<a href="#section-2.3.4-1" class="pilcrow">¶</a></p>
<p id="section-2.3.4-2">Unlike mix-up attacks or audience injection attacks, client configuration confusion attacks do not involve a malicious authorization server, but rather an honest one used in a malicious client configuration.<a href="#section-2.3.4-2" class="pilcrow">¶</a></p>
<div id="ConfigConfusionAttack">
<section id="section-2.3.4.1">
            <h5 id="name-attack-description-3">
<a href="#section-2.3.4.1" class="section-number selfRef">2.3.4.1. </a><a href="#name-attack-description-3" class="section-name selfRef">Attack Description</a>
            </h5>
<p id="section-2.3.4.1-1">Client configuration confusion attacks are feasible if a client satisfies the following preconditions:<a href="#section-2.3.4.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.3.4.1-2">
<li id="section-2.3.4.1-2.1">
                <p id="section-2.3.4.1-2.1.1">The client has at least two client configurations, one of which is configured by an attacker. The client allows for the two configurations to use the same authorization server (i.e., issuer-sharing client configurations) but different resource servers.<a href="#section-2.3.4.1-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-2.3.4.1-2.2">
                <p id="section-2.3.4.1-2.2.1">The client stores the client configuration chosen by the user in a session bound to the user's browser and assigns the same redirection URI for at least the issuer-sharing, if not all, client configurations.<a href="#section-2.3.4.1-2.2.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-2.3.4.1-2.3">
                <p id="section-2.3.4.1-2.3.1">The client uses the same client ID across the issuer-sharing client configurations.<a href="#section-2.3.4.1-2.3.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-2.3.4.1-2.4">
                <p id="section-2.3.4.1-2.4.1">Regarding client authentication, one of the following applies:<a href="#section-2.3.4.1-2.4.1" class="pilcrow">¶</a></p>
</li>
            </ol>
<ul class="normal">
<li class="normal" id="section-2.3.4.1-3.1">
                <p id="section-2.3.4.1-3.1.1">The client authenticates to the authorization server in both client configurations with a signature-based authentication method (e.g., the <code>jwt-bearer</code> client authentication from <span>[<a href="#RFC7523" class="cite xref">RFC7523</a>]</span>) using the same key pair.<a href="#section-2.3.4.1-3.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.3.4.1-3.2">
                <p id="section-2.3.4.1-3.2.1">The client interacts with the authorization server in both client configurations without requiring client authentication (i.e., using the implicit grant, or as a public client).<a href="#section-2.3.4.1-3.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-2.3.4.1-4">For brevity of presentation, in the following, let H-AS, H-RS, and H-Config denote an honest authorization server, resource server, and client configuration, respectively. Let A-AS, A-RS, and A-Config denote an attacker-controlled authorization server, resource server, and client configuration, respectively.<a href="#section-2.3.4.1-4" class="pilcrow">¶</a></p>
<div id="ConfusionCoreSteps">
<section id="section-2.3.4.1.1">
              <h6 id="name-core-attack-steps-2">
<a href="#section-2.3.4.1.1" class="section-number selfRef">2.3.4.1.1. </a><a href="#name-core-attack-steps-2" class="section-name selfRef">Core Attack Steps</a>
              </h6>
<p id="section-2.3.4.1.1-1">In the following, it is further assumed that the client is registered with H-AS for both client configurations. The client is configured to use A-RS for A-Config and H-RS for H-Config.<a href="#section-2.3.4.1.1-1" class="pilcrow">¶</a></p>
<p id="section-2.3.4.1.1-2">Attack on the authorization code grant:<a href="#section-2.3.4.1.1-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.3.4.1.1-3">
<li id="section-2.3.4.1.1-3.1">
                  <p id="section-2.3.4.1.1-3.1.1">The user selects to start the grant using A-Config (e.g., by clicking on a button on the client's website).<a href="#section-2.3.4.1.1-3.1.1" class="pilcrow">¶</a></p>
</li>
                <li id="section-2.3.4.1.1-3.2">
                  <p id="section-2.3.4.1.1-3.2.1">The client stores in the user's session that the user selected "A-Config" and redirects the user to H-AS's authorization endpoint.<a href="#section-2.3.4.1.1-3.2.1" class="pilcrow">¶</a></p>
</li>
                <li id="section-2.3.4.1.1-3.3">
                  <p id="section-2.3.4.1.1-3.3.1">The user authorizes the client to access their resources at H-AS. Having validated that the client ID and redirection URI match the ones assigned for H-Config, H-AS issues a code and sends it (via the browser) back to the client.<a href="#section-2.3.4.1.1-3.3.1" class="pilcrow">¶</a></p>
</li>
                <li id="section-2.3.4.1.1-3.4">
                  <p id="section-2.3.4.1.1-3.4.1">The client redeems the code issued by H-AS at H-AS's token endpoint. To authenticate with H-AS, the client creates a client assertion signed by itself. Recall that both A-Config and H-Config registered the client with H-AS under the same client ID, and that the client uses the same key pair for authentication at H-AS. Hence, this client assertion, if required, would be a valid authentication credential for the client at H-AS. Note that generating and validating client assertions in this step is irrelevant for public clients.<a href="#section-2.3.4.1.1-3.4.1" class="pilcrow">¶</a></p>
</li>
                <li id="section-2.3.4.1.1-3.5">
                  <p id="section-2.3.4.1.1-3.5.1">Since the client stores "A-Config" in the user's session, it sends the access token to A-RS. The attacker therefore obtains the user's access token issued by H-AS.<a href="#section-2.3.4.1.1-3.5.1" class="pilcrow">¶</a></p>
</li>
              </ol>
<p id="section-2.3.4.1.1-4">Variant in Implicit Grant:
In the implicit grant, H-AS issues an access token instead of the code in Step 3. Step 4 is omitted. The rest of the attack proceeds as above.<a href="#section-2.3.4.1.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="discussion-on-sharing-client-ids">
<section id="section-2.3.4.1.2">
              <h6 id="name-discussion-on-sharing-clien">
<a href="#section-2.3.4.1.2" class="section-number selfRef">2.3.4.1.2. </a><a href="#name-discussion-on-sharing-clien" class="section-name selfRef">Discussion: on Sharing Client IDs</a>
              </h6>
<p id="section-2.3.4.1.2-1">The scope of client configuration confusion attack is limited to the reuse of registered clients, and considers phishing threats involving the open registration of new clients as out of scope, because such threats can be mitigated by existing mechanisms such as vetting during manual registration, or via initial access tokens as defined in <span><a href="https://rfc-editor.org/rfc/rfc7591#section-1.2" class="relref">Section 1.2</a> of [<a href="#RFC7591" class="cite xref">RFC7591</a>]</span>.<a href="#section-2.3.4.1.2-1" class="pilcrow">¶</a></p>
<p id="section-2.3.4.1.2-2">For the attack to work, A-Config and H-Config need to share the same client ID in client registration (precondition 3 in <a href="#ConfigConfusionAttack" class="auto internal xref">Section 2.3.4.1</a>). This can be the case, for example, if an external developer or end-user can control the client ID used in A-Config during manual registration, or if the client uses dynamic registration to get assigned the same client ID for A-Config as in H-Config, as detailed below.<a href="#section-2.3.4.1.2-2" class="pilcrow">¶</a></p>
<p id="section-2.3.4.1.2-3">When the client is designed to perform dynamic client registration once per client configuration, A-Config and H-Config could feasibly share the same client ID.
Unlike the situation in <a href="#AudienceInjection" class="auto internal xref">Section 2.1</a>, since A-Config uses H-AS instead of A-AS, the attacker cannot directly control which client ID the authorization server assigns to A-Config.
However, according to the description of client ID returned in Client Information Response (<span><a href="https://rfc-editor.org/rfc/rfc7591#section-3.2.1" class="relref">Section 3.2.1</a> of [<a href="#RFC7591" class="cite xref">RFC7591</a>]</span>):<a href="#section-2.3.4.1.2-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.3.4.1.2-4">
                <dt id="section-2.3.4.1.2-4.1">client_id</dt>
                <dd style="margin-left: 1.5em" id="section-2.3.4.1.2-4.2">
                  <p id="section-2.3.4.1.2-4.2.1">OAuth 2.0 client identifier string.  It <span class="bcp14">SHOULD NOT</span> be currently valid for any other registered client, though an authorization server <span class="bcp14">MAY</span> issue the same client identifier to multiple instances of a registered client at its discretion.<a href="#section-2.3.4.1.2-4.2.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
</dl>
<p id="section-2.3.4.1.2-5">The second half of the last sentence explicitly allows a client to obtain a client ID of the same value across multiple client registrations, as long as the client is considered to be instances of the same registered client by the authorization server.<a href="#section-2.3.4.1.2-5" class="pilcrow">¶</a></p>
<p id="section-2.3.4.1.2-6">This behavior is intended for registering different "client instances", i.e., different deployed instances of the same piece of client software (see <span><a href="https://rfc-editor.org/rfc/rfc7591#section-1.2" class="relref">Section 1.2</a> of [<a href="#RFC7591" class="cite xref">RFC7591</a>]</span>). However, the authorization server cannot distinguish between this case and a client registering multiple times for different client configurations.<a href="#section-2.3.4.1.2-6" class="pilcrow">¶</a></p>
<p id="section-2.3.4.1.2-7">Specifically, when the client initiates dynamic registration at H-AS based on H-Config and A-Config respectively, the authorization server, recognizing the two client registration requests as originating from the same client (e.g., indicated by the identical software identifier or software statement provided by the client, see <span><a href="https://rfc-editor.org/rfc/rfc7591#section-2" class="relref">Section 2</a> of [<a href="#RFC7591" class="cite xref">RFC7591</a>]</span> for their definitions), is likely to return the same client ID according to <span><a href="https://rfc-editor.org/rfc/rfc7591#appendix-A.4.2" class="relref">Appendix A.4.2</a> of [<a href="#RFC7591" class="cite xref">RFC7591</a>]</span>:<a href="#section-2.3.4.1.2-7" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.3.4.1.2-8.1">
                  <p id="section-2.3.4.1.2-8.1.1">Particular authorization servers might choose, for instance, to maintain a mapping between software statement values and client identifier values, and return the same client identifier value for all registration requests for a particular piece of software.<a href="#section-2.3.4.1.2-8.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<p id="section-2.3.4.1.2-9">Therefore, a client interacting with H-Config and A-Config could feasibly share the same client ID when dynamic client registration is used.<a href="#section-2.3.4.1.2-9" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ConfigConfusionCountermeasures">
<section id="section-2.3.4.2">
            <h5 id="name-countermeasures-3">
<a href="#section-2.3.4.2" class="section-number selfRef">2.3.4.2. </a><a href="#name-countermeasures-3" class="section-name selfRef">Countermeasures</a>
            </h5>
<p id="section-2.3.4.2-1">At its core, client configuration confusion attacks exploit the fact that, an attacker-controlled client configuration can reuse the registered client at the honest authorization server under an honest client configuration.<a href="#section-2.3.4.2-1" class="pilcrow">¶</a></p>
<p id="section-2.3.4.2-2">Clients in open ecosystems that interact with more than one client configuration and support authorization servers that either use signature-based client authentication methods or do not require client authentication <span class="bcp14">MUST</span> employ the following countermeasure, unless client configuration confusion attacks are mitigated by other means, such as using fresh key material for each authorization server employing signature-based client authentication and disallowing any authorization server that does not require client authentication.<a href="#section-2.3.4.2-2" class="pilcrow">¶</a></p>
<p id="section-2.3.4.2-3">Clients <span class="bcp14">MUST</span> issue a distinct redirection URI for each client configuration they interact with, both during client registration and in OAuth flows. This ensures that the redirection URI for the attacker-controlled client configuration will fail the exact redirection URI match (required by <span><a href="https://rfc-editor.org/rfc/rfc9700#section-4.1.3" class="relref">Section 4.1.3</a> of [<a href="#RFC9700" class="cite xref">RFC9700</a>]</span>) at the honest authorization server, since the redirection URI at the honest client configuration is the only redirection URI registered for the client identifier at the honest authorization server.<a href="#section-2.3.4.2-3" class="pilcrow">¶</a></p>
<p id="section-2.3.4.2-4">When dynamic client registration is supported, clients <span class="bcp14">SHOULD</span> also specify a different software identifier (<code>software_id</code>) in client registration requests for each client configuration. This prevents client registration requests from being rejected by the authorization server when different redirection URIs are used, if the authorization server follows the excerpt from <span><a href="https://rfc-editor.org/rfc/rfc7591#section-5" class="relref">Section 5</a> of [<a href="#RFC7591" class="cite xref">RFC7591</a>]</span> below:<a href="#section-2.3.4.2-4" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.3.4.2-5.1">
                <p id="section-2.3.4.2-5.1.1">An authorization server could also refuse registration requests from a known software identifier that is requesting different redirection URIs or a different client URI.<a href="#section-2.3.4.2-5.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-2.3.4.2-6">This countermeasure can be considered an actionable approach to mitigating the "Counterfeit Resource Server" threat (see "Access Token Phishing by Counterfeit Resource Server" in <span><a href="https://rfc-editor.org/rfc/rfc9700#section-4.9.1" class="relref">Section 4.9.1</a> of [<a href="#RFC9700" class="cite xref">RFC9700</a>]</span>) within the context of open ecosystems. It is complementary to general defenses for access token misuses, such as sender-constrained and audience-restricted access tokens as specified in <span><a href="https://rfc-editor.org/rfc/rfc9700#section-4.10" class="relref">Section 4.10</a> of [<a href="#RFC9700" class="cite xref">RFC9700</a>]</span>.<a href="#section-2.3.4.2-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="Security">
<section id="section-3">
      <h2 id="name-security-considerations">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-3-1">Security considerations are described in <a href="#AttacksMitigations" class="auto internal xref">Section 2</a>.<a href="#section-3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="IANA">
<section id="section-4">
      <h2 id="name-iana-considerations">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-4-1">This document has no IANA actions.<a href="#section-4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-combined-references">
<section id="section-5">
      <h2 id="name-references">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-5.1">
        <h3 id="name-normative-references">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6749">[RFC6749]</dt>
        <dd>
<span class="refAuthor">Hardt, D., Ed.</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework"</span>, <span class="seriesInfo">RFC 6749</span>, <span class="seriesInfo">DOI 10.17487/RFC6749</span>, <time datetime="2012-10" class="refDate">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6749">https://www.rfc-editor.org/rfc/rfc6749</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7521">[RFC7521]</dt>
        <dd>
<span class="refAuthor">Campbell, B.</span>, <span class="refAuthor">Mortimore, C.</span>, <span class="refAuthor">Jones, M.</span>, and <span class="refAuthor">Y. Goland</span>, <span class="refTitle">"Assertion Framework for OAuth 2.0 Client Authentication and Authorization Grants"</span>, <span class="seriesInfo">RFC 7521</span>, <span class="seriesInfo">DOI 10.17487/RFC7521</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7521">https://www.rfc-editor.org/rfc/rfc7521</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7523">[RFC7523]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Campbell, B.</span>, and <span class="refAuthor">C. Mortimore</span>, <span class="refTitle">"JSON Web Token (JWT) Profile for OAuth 2.0 Client Authentication and Authorization Grants"</span>, <span class="seriesInfo">RFC 7523</span>, <span class="seriesInfo">DOI 10.17487/RFC7523</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7523">https://www.rfc-editor.org/rfc/rfc7523</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8414">[RFC8414]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Sakimura, N.</span>, and <span class="refAuthor">J. Bradley</span>, <span class="refTitle">"OAuth 2.0 Authorization Server Metadata"</span>, <span class="seriesInfo">RFC 8414</span>, <span class="seriesInfo">DOI 10.17487/RFC8414</span>, <time datetime="2018-06" class="refDate">June 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8414">https://www.rfc-editor.org/rfc/rfc8414</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9700">[RFC9700]</dt>
      <dd>
<span class="refAuthor">Lodderstedt, T.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Labunets, A.</span>, and <span class="refAuthor">D. Fett</span>, <span class="refTitle">"Best Current Practice for OAuth 2.0 Security"</span>, <span class="seriesInfo">BCP 240</span>, <span class="seriesInfo">RFC 9700</span>, <span class="seriesInfo">DOI 10.17487/RFC9700</span>, <time datetime="2025-01" class="refDate">January 2025</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9700">https://www.rfc-editor.org/rfc/rfc9700</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-5.2">
        <h3 id="name-informative-references">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="arXiv.1601.01229">[arXiv.1601.01229]</dt>
        <dd>
<span class="refAuthor">Fett, D.</span>, <span class="refAuthor">Küsters, R.</span>, and <span class="refAuthor">G. Schmitz</span>, <span class="refTitle">"A Comprehensive Formal Security Analysis of OAuth 2.0"</span>, <span class="refContent">arXiv:1601.01229</span>, <time datetime="2016-01" class="refDate">January 2016</time>, <span>&lt;<a href="https://arxiv.org/abs/1601.01229/">https://arxiv.org/abs/1601.01229/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="MCP-Spec">[MCP-Spec]</dt>
        <dd>
<span class="refAuthor">Anthropic</span>, <span class="refTitle">"Model Context Protocol (MCP) Specification"</span>, <time datetime="2025-03" class="refDate">March 2025</time>, <span>&lt;<a href="https://modelcontextprotocol.io/specification/2025-03-26">https://modelcontextprotocol.io/specification/2025-03-26</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OAUTH-7523bis">[OAUTH-7523bis]</dt>
        <dd>
<span class="refAuthor">Jones, M. B.</span>, <span class="refAuthor">Campbell, B.</span>, and <span class="refAuthor">C. Mortimore</span>, <span class="refTitle">"JSON Web Token (JWT) Profile for OAuth 2.0 Client Authentication and Authorization Grants"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-oauth-rfc7523bis-00</span>, <time datetime="2025-02-21" class="refDate">21 February 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-oauth-rfc7523bis-00">https://datatracker.ietf.org/doc/html/draft-ietf-oauth-rfc7523bis-00</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OpenID.CIBA">[OpenID.CIBA]</dt>
        <dd>
<span class="refAuthor">Fernandez, G.</span>, <span class="refAuthor">Walter, F.</span>, <span class="refAuthor">Nennker, A.</span>, <span class="refAuthor">Tonge, D.</span>, and <span class="refAuthor">B. Campbell</span>, <span class="refTitle">"OpenID Connect Client-Initiated Backchannel Authentication Flow - Core 1.0"</span>, <time datetime="2021-09" class="refDate">September 2021</time>, <span>&lt;<a href="https://openid.net/specs/openid-client-initiated-backchannel-authentication-core-1_0.html">https://openid.net/specs/openid-client-initiated-backchannel-authentication-core-1_0.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OpenID.Core">[OpenID.Core]</dt>
        <dd>
<span class="refAuthor">Sakimura, N.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Jones, M.</span>, <span class="refAuthor">de Medeiros, B.</span>, and <span class="refAuthor">C. Mortimore</span>, <span class="refTitle">"OpenID Connect Core 1.0 incorporating errata set 2"</span>, <time datetime="2023-12" class="refDate">December 2023</time>, <span>&lt;<a href="https://openid.net/specs/openid-connect-core-1_0.html">https://openid.net/specs/openid-connect-core-1_0.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OpenID.Discovery">[OpenID.Discovery]</dt>
        <dd>
<span class="refAuthor">Sakimura, N.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Jones, M.</span>, and <span class="refAuthor">E. Jay</span>, <span class="refTitle">"OpenID Connect Discovery 1.0 incorporating errata set 2"</span>, <time datetime="2023-12" class="refDate">December 2023</time>, <span>&lt;<a href="https://openid.net/specs/openid-connect-discovery-1_0.html">https://openid.net/specs/openid-connect-discovery-1_0.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="research.cuhk">[research.cuhk]</dt>
        <dd>
<span class="refAuthor">Luo, K.</span>, <span class="refAuthor">Wang, X.</span>, <span class="refAuthor">Fung, P. H. A.</span>, <span class="refAuthor">Lau, W. C.</span>, and <span class="refAuthor">J. Lecomte</span>, <span class="refTitle">"Universal Cross-app Attacks: Exploiting and Securing OAuth 2.0 in Integration Platforms"</span>, <span class="refContent">34th USENIX Security Symposium (USENIX Security 25)</span>, <time datetime="2025-08" class="refDate">August 2025</time>, <span>&lt;<a href="https://www.usenix.org/system/files/conference/usenixsecurity25/sec24winter-prepub-332-luo.pdf">https://www.usenix.org/system/files/conference/usenixsecurity25/sec24winter-prepub-332-luo.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="research.jcs_14">[research.jcs_14]</dt>
        <dd>
<span class="refAuthor">Bansal, C.</span>, <span class="refAuthor">Bhargavan, K.</span>, <span class="refAuthor">Delignat-Lavaud, A.</span>, and <span class="refAuthor">S. Maffeis</span>, <span class="refTitle">"Discovering concrete attacks on website authorization by formal analysis"</span>, <span class="refContent">Journal of Computer Security, vol. 22, no. 4, pp. 601-657</span>, <time datetime="2014-04" class="refDate">April 2014</time>, <span>&lt;<a href="https://www.doc.ic.ac.uk/~maffeis/papers/jcs14.pdf">https://www.doc.ic.ac.uk/~maffeis/papers/jcs14.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="research.ust">[research.ust]</dt>
        <dd>
<span class="refAuthor">Hosseyni, P.</span>, <span class="refAuthor">Küsters, R.</span>, and <span class="refAuthor">T. Würtele</span>, <span class="refTitle">"Audience Injection Attacks: A New Class of Attacks on Web-Based Authorization and Authentication Standards"</span>, <time datetime="2025-04" class="refDate">April 2025</time>, <span>&lt;<a href="https://eprint.iacr.org/2025/629">https://eprint.iacr.org/2025/629</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7009">[RFC7009]</dt>
        <dd>
<span class="refAuthor">Lodderstedt, T., Ed.</span>, <span class="refAuthor">Dronia, S.</span>, and <span class="refAuthor">M. Scurtescu</span>, <span class="refTitle">"OAuth 2.0 Token Revocation"</span>, <span class="seriesInfo">RFC 7009</span>, <span class="seriesInfo">DOI 10.17487/RFC7009</span>, <time datetime="2013-08" class="refDate">August 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7009">https://www.rfc-editor.org/rfc/rfc7009</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7519">[RFC7519]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Sakimura</span>, <span class="refTitle">"JSON Web Token (JWT)"</span>, <span class="seriesInfo">RFC 7519</span>, <span class="seriesInfo">DOI 10.17487/RFC7519</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7519">https://www.rfc-editor.org/rfc/rfc7519</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7522">[RFC7522]</dt>
        <dd>
<span class="refAuthor">Campbell, B.</span>, <span class="refAuthor">Mortimore, C.</span>, and <span class="refAuthor">M. Jones</span>, <span class="refTitle">"Security Assertion Markup Language (SAML) 2.0 Profile for OAuth 2.0 Client Authentication and Authorization Grants"</span>, <span class="seriesInfo">RFC 7522</span>, <span class="seriesInfo">DOI 10.17487/RFC7522</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7522">https://www.rfc-editor.org/rfc/rfc7522</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7591">[RFC7591]</dt>
        <dd>
<span class="refAuthor">Richer, J., Ed.</span>, <span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Machulak, M.</span>, and <span class="refAuthor">P. Hunt</span>, <span class="refTitle">"OAuth 2.0 Dynamic Client Registration Protocol"</span>, <span class="seriesInfo">RFC 7591</span>, <span class="seriesInfo">DOI 10.17487/RFC7591</span>, <time datetime="2015-07" class="refDate">July 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7591">https://www.rfc-editor.org/rfc/rfc7591</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8628">[RFC8628]</dt>
        <dd>
<span class="refAuthor">Denniss, W.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Jones, M.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"OAuth 2.0 Device Authorization Grant"</span>, <span class="seriesInfo">RFC 8628</span>, <span class="seriesInfo">DOI 10.17487/RFC8628</span>, <time datetime="2019-08" class="refDate">August 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8628">https://www.rfc-editor.org/rfc/rfc8628</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9126">[RFC9126]</dt>
        <dd>
<span class="refAuthor">Lodderstedt, T.</span>, <span class="refAuthor">Campbell, B.</span>, <span class="refAuthor">Sakimura, N.</span>, <span class="refAuthor">Tonge, D.</span>, and <span class="refAuthor">F. Skokan</span>, <span class="refTitle">"OAuth 2.0 Pushed Authorization Requests"</span>, <span class="seriesInfo">RFC 9126</span>, <span class="seriesInfo">DOI 10.17487/RFC9126</span>, <time datetime="2021-09" class="refDate">September 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9126">https://www.rfc-editor.org/rfc/rfc9126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9207">[RFC9207]</dt>
        <dd>
<span class="refAuthor">Meyer zu Selhausen, K.</span> and <span class="refAuthor">D. Fett</span>, <span class="refTitle">"OAuth 2.0 Authorization Server Issuer Identification"</span>, <span class="seriesInfo">RFC 9207</span>, <span class="seriesInfo">DOI 10.17487/RFC9207</span>, <time datetime="2022-03" class="refDate">March 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9207">https://www.rfc-editor.org/rfc/rfc9207</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9728">[RFC9728]</dt>
      <dd>
<span class="refAuthor">Jones, M.B.</span>, <span class="refAuthor">Hunt, P.</span>, and <span class="refAuthor">A. Parecki</span>, <span class="refTitle">"OAuth 2.0 Protected Resource Metadata"</span>, <span class="seriesInfo">RFC 9728</span>, <span class="seriesInfo">DOI 10.17487/RFC9728</span>, <time datetime="2025-04" class="refDate">April 2025</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9728">https://www.rfc-editor.org/rfc/rfc9728</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="Acknowledgements">
<section id="appendix-A">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-A-1">We would like to thank
<span class="cref" id="acksAddNames">TODO add names, sort by last name.<span class="crefSource">Tim W.</span></span>
Daniel Fett,
Wing Cheong Lau,
Julien Lecomte,
Aaron Parecki,
Guido Schmitz, and
Xianbo Wang<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2">for their valuable feedback and contributions to this document.<a href="#appendix-A-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="document-history">
<section id="appendix-B">
      <h2 id="name-document-history">
<a href="#name-document-history" class="section-name selfRef">Document History</a>
      </h2>
<p id="appendix-B-1">[[ To be removed from the final specification ]]<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">-01<a href="#appendix-B-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-3.1">
          <p id="appendix-B-3.1.1">Updated temporary title<a href="#appendix-B-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-3.2">
          <p id="appendix-B-3.2.1">Added introductory paragraphs, replaced placeholders<a href="#appendix-B-3.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-3.3">
          <p id="appendix-B-3.3.1">Clarified issuer does not uniquely identify client config<a href="#appendix-B-3.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-3.4">
          <p id="appendix-B-3.4.1">Cleaned up acknowledgement list<a href="#appendix-B-3.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-B-4">-00<a href="#appendix-B-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-5.1">
          <p id="appendix-B-5.1.1">Initial version<a href="#appendix-B-5.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Tim Würtele</span></div>
<div dir="auto" class="left"><span class="org">University of Stuttgart</span></div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:tim.wuertele@sec.uni-stuttgart.de" class="email">tim.wuertele@sec.uni-stuttgart.de</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Pedram Hosseyni</span></div>
<div dir="auto" class="left"><span class="org">University of Stuttgart</span></div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:pedram.hosseyni@sec.uni-stuttgart.de" class="email">pedram.hosseyni@sec.uni-stuttgart.de</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Kaixuan Luo</span></div>
<div dir="auto" class="left"><span class="org">The Chinese University of Hong Kong</span></div>
<div dir="auto" class="left"><span class="country-name">Hong Kong</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:kaixuan@ie.cuhk.edu.hk" class="email">kaixuan@ie.cuhk.edu.hk</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Adonis Fung</span></div>
<div dir="auto" class="left"><span class="org">Samsung Research America</span></div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:adonis.fung@samsung.com" class="email">adonis.fung@samsung.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
